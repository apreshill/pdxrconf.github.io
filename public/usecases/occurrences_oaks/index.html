<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>rOpenSci | Comparing occurrence data for valley oaks</title>

     
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>

    <script type="text/javascript">
    hljs.configure({languages: []});
    hljs.initHighlightingOnLoad();
    </script>
    <link rel="stylesheet" type="text/css" href="/css/style-new.css" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#4b8add">
<meta name="theme-color" content="#4b8add">


    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

    
    <div id="header">
        <div class="container">
            <div class="row center-m">
                
                <div class="col-1">
                    <a href="/index.html"><img src="/img/icon_lettering_white.svg" /></a>
                </div>
                
                
                <nav class="col-6 col-offset-4 top-3">
                    <ul class="row between">
						<li><a href="/about/">About</a></li>
                        <li><a href="/blog/">Blog</a></li>
                        <li><a href="/packages/">Packages</a></li>
                        <li><a href="/community/">Community</a></li>
                        <li><a href="http://discuss.ropensci.org/" target="_blank">Discuss</a></li>

                    </ul>
                </nav>
                
            </div>
        </div>
    </div>



    <article>
        <div class="container top-20">
            <div class="row centered">

                
                <div class="col-7 bottom-20 maintext">
                    <h1>Comparing occurrence data for valley oaks</h1>
                    <br>
                    <h4><small style="color:grey">rOpenSci package: <a href="https://github.com/ropensci/rgbif">rgbif</a></small></h4>
                    <br><br>
                    <article>
                    

<p>This example comes from <a href="https://twitter.com/ajpelu">Antonio J. Perez-Luque</a> who <a href="https://twitter.com/ajpelu/status/473951167567757312">shared his plot on
Twitter</a>. Antonio compared the occurrences of Valley Oak (<em>Quercus lobata</em>) from <a href="http://www.gbif.org/">GBIF</a> to the distribution of the same species from the <a href="http://esp.cr.usgs.gov/data/little/">Atlas of US Trees</a>.</p>

<h3 id="load-libraries">Load libraries</h3>

<pre><code class="language-r">library('rgbif')
library('raster')
library('sp')
library('maptools')
library('rgeos')
library('scales')
</code></pre>

<h3 id="get-gbif-data-for-quercus-lobata">Get GBIF Data for Quercus lobata</h3>

<pre><code class="language-r">keyQl &lt;- name_backbone(name='Quercus lobata', kingdom='plants')$speciesKey
dat.Ql &lt;- occ_search(taxonKey=keyQl, return='data', limit=50000)
</code></pre>

<h3 id="get-distribution-map-of-q-lobata-atlas-of-us-trees-little-e">Get Distribution map of Q. lobata Atlas of US Trees (Little, E.)</h3>

<p>From <a href="http://esp.cr.usgs.gov/data/little/">http://esp.cr.usgs.gov/data/little/</a>. And save shapefile in same
directory</p>

<pre><code class="language-r">url &lt;- 'http://esp.cr.usgs.gov/data/little/querloba.zip'
tmp &lt;- tempdir()
download.file(url, destfile = &quot;~/querloba.zip&quot;)
unzip(&quot;~/querloba.zip&quot;, exdir = &quot;querloba&quot;)
ql &lt;- readShapePoly(&quot;~/querloba/querloba.shp&quot;)
</code></pre>

<h3 id="get-elevation-data-of-us">Get Elevation data of US</h3>

<pre><code class="language-r">alt.USA &lt;- getData('alt', country='USA')
</code></pre>

<h3 id="create-hillshade-of-us">Create Hillshade of US</h3>

<pre><code class="language-r">alt.USA &lt;- alt.USA[[1]]
slope.USA &lt;- terrain(alt.USA, opt='slope')
aspect.USA &lt;- terrain(alt.USA, opt='aspect')
hill.USA &lt;- hillShade(slope.USA, aspect.USA, angle=45, direction=315)
</code></pre>

<h3 id="plot-map">Plot map</h3>

<pre><code class="language-r">plot(hill.USA, col=grey(0:100/100), legend=FALSE, xlim=c(-125,-116), ylim=c(32,42), main='Distribution of Quercus lobata', xlab=&quot;Long&quot;, ylab='Lat')
# add shape from Atlas of US Trees
plot(ql, add=TRUE, col=alpha(&quot;white&quot;, 0.6), border=FALSE)
# add Gbif presence points
points(dat.Ql$decimalLongitude, dat.Ql$decimalLatitude, cex=.7, pch=19, col=alpha(&quot;darkgreen&quot;, 0.8))
legend(x=-121, y=40.5, &quot;GBIF Data&quot;, pch=19, col='darkgreen', bty='n', pt.cex=1, cex=.8)
legend(x=-121, y=41.5, &quot;Atlas of United States Trees \n (Little, E. 1971)&quot;, pt.cex=1.5, cex=.8, pch=19, col='white', bty='n')
</code></pre>

<p><img src="/img/usecases-images/oaks.png" alt="png" /></p>

                    </article>
                </div>

                </div>
            </div>
        </div>
    </article>


    <div id="footer">
        <div class="container">
            <div class="row start">
                <div class="col-1 col-1-3 top-8">
                    <img src="/img/icon_short_white.svg" />
                </div>

                <div class="col-9 col-offset-2 top-10 bottom-8">
                    <div class="row between">
                        <div class="col-2 col-1-3">
                            <a href="http://github.com/ropensci" target="_blank"><div class="icon icon-github"></div></a>
                            <a href="http://twitter.com/ropensci" target="_blank"><div class="icon icon-twitter"></div></a>
                            <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon icon-vimeo"></div></a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Info</h5>
                                <li><a href="/about">Mission</a></li>
                                <li><a href="/about#team">Team</a></li>
                                <li><a href="/about#collaborators">Collaborators</a></li>
                                <li><a href="/careers">Careers</a></li>

                            </ul>
                        </div>

                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Work</h5>
                                <li><a href="/packages/">Packages</a></li>
                                <li><a href="/blog/">Blog</a></li>
                                <li><a href="/technotes/">Tech Notes</a></li>
                                <li><a href="/tutorials/">Tutorials</a></li>
                                <li><a href="/usecases/">Use Cases</a></li>
                                <li><a href="/resources/">More Resources</a></li>
                            </ul>
                        </div>
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Participate</h5>
                                <li><a href="/contact.html">Contact us</a></li>
                                <li><a href="/community/">Community</a></li>
                                <li><a href="http://onboarding.ropensci.org/">Contribute software</a></li>
                                <li><a href="http://unconf17.ropensci.org/">Unconference</a></li>
                                <li><a href="/coc">Code of conduct</a></li>
                                <li><a href="/donate/">Donate</a></li>
                            </ul>
                        </div>
                        <div class="col-4 top-8 bottom-8">
                            <h5 class="bottom-2"></h5>

                            <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                            <a href="http://numfocus.org" target="_blank"><img src="img/numfocus.png"></a>
                            <br>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 top-8 bottom-9 divider">
                    <p class="top-9">Except where otherwise noted, content on this site is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY license</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>



</body>
</html>
