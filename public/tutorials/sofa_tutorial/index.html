<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>rOpenSci | sofa tutorial</title>

     
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>

    <script type="text/javascript">
    hljs.configure({languages: []});
    hljs.initHighlightingOnLoad();
    </script>
    <link rel="stylesheet" type="text/css" href="/css/style-new.css" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#4b8add">
<meta name="theme-color" content="#4b8add">


    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

    
    <div id="header">
        <div class="container">
            <div class="row center-m">
                
                <div class="col-1">
                    <a href="/index.html"><img src="/img/icon_lettering_white.svg" /></a>
                </div>
                
                
                <nav class="col-6 col-offset-4 top-3">
                    <ul class="row between">
						<li><a href="/about/">About</a></li>
                        <li><a href="/blog/">Blog</a></li>
                        <li><a href="/packages/">Packages</a></li>
                        <li><a href="/community/">Community</a></li>
                        <li><a href="http://discuss.ropensci.org/" target="_blank">Discuss</a></li>

                    </ul>
                </nav>
                
            </div>
        </div>
    </div>



    <article>
        <div class="container top-20">
            
            <div class="row centered">
                
                <div class="col-7 bottom-20 maintext">
                    <h1>sofa tutorial</h1>
                    <br>
                    <h4><small style="color:grey">for v0.2.0</small></h4>
                    <br>

                    <article>
                    

<p><code>sofa</code> provides an interface to the &lsquo;NoSQL&rsquo; database &lsquo;CouchDB&rsquo; (<a href="http://couchdb.apache.org">http://couchdb.apache.org</a>).</p>

<p>CouchDB links</p>

<ul>
<li><a href="http://couchdb.apache.org/">Apache CouchDB</a>.</li>
<li><a href="http://guide.couchdb.org/">CouchDB guide - online book and hard copy</a>.</li>
</ul>

<h2 id="install-couchdb">Install CouchDB</h2>

<p>Go to <a href="http://docs.couchdb.org/en/2.0.0/install/index.html">http://docs.couchdb.org/en/2.0.0/install/index.html</a> for instructions.</p>

<h2 id="connect-to-couchdb">Connect to CouchDB</h2>

<p>This may be starting it on your terminal/shell</p>

<pre><code class="language-sh">couchdb
</code></pre>

<p>Or opening the CouchDB app on your machine, or running it in docker. Whatever it
is, start it up.</p>

<p>You can interact with your CouchDB databases as well in your browser. Navigate to <a href="http://localhost:5984/_utils">http://localhost:5984/_utils</a></p>

<h3 id="installation">Installation</h3>

<p>Stable version from CRAN</p>

<pre><code class="language-r">install.packages(&quot;sofa&quot;)
</code></pre>

<p>Development version from GitHub</p>

<pre><code class="language-r">if (!require(&quot;devtools&quot;)) install.packages(&quot;devtools&quot;)
devtools::install_github(&quot;ropensci/sofa&quot;)
</code></pre>

<pre><code class="language-r">library(&quot;sofa&quot;)
</code></pre>

<h2 id="usage">Usage</h2>

<h3 id="create-a-connection-client">Create a connection client</h3>

<pre><code class="language-r">(x &lt;- Cushion$new())
#&gt; &lt;sofa - cushion&gt; 
#&gt;   transport: http
#&gt;   host: 127.0.0.1
#&gt;   port: 5984
#&gt;   path: 
#&gt;   type: 
#&gt;   user: 
#&gt;   pwd:
</code></pre>

<h3 id="ping-your-server">Ping your server</h3>

<pre><code class="language-r">ping(x)
#&gt; $couchdb
#&gt; [1] &quot;Welcome&quot;
#&gt; 
#&gt; $version
#&gt; [1] &quot;2.1.0&quot;
#&gt; 
#&gt; $features
#&gt; $features[[1]]
#&gt; [1] &quot;scheduler&quot;
#&gt; 
#&gt; 
#&gt; $vendor
#&gt; $vendor$name
#&gt; [1] &quot;The Apache Software Foundation&quot;
</code></pre>

<h3 id="create-a-new-database">Create a new database</h3>

<pre><code class="language-r">db_create(x, 'cats')
#&gt; $ok
#&gt; [1] TRUE
</code></pre>

<h3 id="list-databases">List databases</h3>

<pre><code class="language-r">db_list(x)
#&gt;  [1] &quot;bulkfromchr&quot; &quot;bulktest2&quot;   &quot;bulktest3&quot;   &quot;cats&quot;        &quot;cchecksdb&quot;  
#&gt;  [6] &quot;drinksdb&quot;    &quot;iris190&quot;     &quot;iris984&quot;     &quot;irisrows&quot;    &quot;testing123&quot;
</code></pre>

<h3 id="create-a-document">Create a document</h3>

<pre><code class="language-r">doc1 &lt;- '{&quot;name&quot;: &quot;leo&quot;, &quot;color&quot;: &quot;blue&quot;, &quot;furry&quot;: true, &quot;size&quot;: 1}'
doc_create(x, dbname = &quot;cats&quot;, doc1, docid = &quot;bluecat&quot;)
#&gt; $ok
#&gt; [1] TRUE
#&gt; 
#&gt; $id
#&gt; [1] &quot;bluecat&quot;
#&gt; 
#&gt; $rev
#&gt; [1] &quot;1-41784f190c466d990684003a958c9f39&quot;
</code></pre>

<p>and another!</p>

<pre><code class="language-r">doc2 &lt;- '{&quot;name&quot;: &quot;samson&quot;, &quot;color&quot;: &quot;red&quot;, &quot;furry&quot;: false, &quot;size&quot;: 3}'
doc_create(x, dbname = &quot;cats&quot;, doc2)
#&gt; $ok
#&gt; [1] TRUE
#&gt; 
#&gt; $id
#&gt; [1] &quot;faa356c2302d8c8ac5800effc3000f83&quot;
#&gt; 
#&gt; $rev
#&gt; [1] &quot;1-08aef850a23f5ff95869c9cf5d9604dc&quot;
</code></pre>

<p>and one more, cause 3&rsquo;s company</p>

<pre><code class="language-r">doc3 &lt;- '{&quot;name&quot;: &quot;matilda&quot;, &quot;color&quot;: &quot;green&quot;, &quot;furry&quot;: false, &quot;size&quot;: 5}'
doc_create(x, dbname = &quot;cats&quot;, doc3)
#&gt; $ok
#&gt; [1] TRUE
#&gt; 
#&gt; $id
#&gt; [1] &quot;faa356c2302d8c8ac5800effc300131a&quot;
#&gt; 
#&gt; $rev
#&gt; [1] &quot;1-73443af61b0149e4c3e138b870e72602&quot;
</code></pre>

<p>Note how we used a document id in the first document creation, but
not in the second. Using a document id is optional.</p>

<h3 id="changes-feed">Changes feed</h3>

<pre><code class="language-r">db_changes(x, &quot;cats&quot;)
#&gt; $results
#&gt; $results[[1]]
#&gt; $results[[1]]$seq
#&gt; [1] &quot;1-g1AAAAB5eJzLYWBgYMpgTmEQTM4vTc5ISXLIyU9OzMnILy7JAUklMiTV____PyuDOZExFyjAbm5pmmRsaoxNAx5j8liAJEMDkPoPMi2RIQsAr18mRA&quot;
#&gt; 
#&gt; $results[[1]]$id
#&gt; [1] &quot;faa356c2302d8c8ac5800effc300131a&quot;
#&gt; 
#&gt; $results[[1]]$changes
#&gt; $results[[1]]$changes[[1]]
#&gt; $results[[1]]$changes[[1]]$rev
#&gt; [1] &quot;1-73443af61b0149e4c3e138b870e72602&quot;
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; $results[[2]]
#&gt; $results[[2]]$seq
#&gt; [1] &quot;2-g1AAAACbeJzLYWBgYMpgTmEQTM4vTc5ISXLIyU9OzMnILy7JAUklMiTV____PyuDOZExFyjAbm5pmmRsaoxNAx5j8liAJEMDkPqPYlqKhYl5moUhNn1ZAFAWMFA&quot;
#&gt; 
#&gt; $results[[2]]$id
#&gt; [1] &quot;bluecat&quot;
#&gt; 
#&gt; $results[[2]]$changes
#&gt; $results[[2]]$changes[[1]]
#&gt; $results[[2]]$changes[[1]]$rev
#&gt; [1] &quot;1-41784f190c466d990684003a958c9f39&quot;
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; $results[[3]]
#&gt; $results[[3]]$seq
#&gt; [1] &quot;3-g1AAAACbeJzLYWBgYMpgTmEQTM4vTc5ISXLIyU9OzMnILy7JAUklMiTV____PyuDOZExFyjAbm5pmmRsaoxNAx5j8liAJEMDkPoPNY0JbFqKhYl5moUhNn1ZAFA4MFE&quot;
#&gt; 
#&gt; $results[[3]]$id
#&gt; [1] &quot;faa356c2302d8c8ac5800effc3000f83&quot;
#&gt; 
#&gt; $results[[3]]$changes
#&gt; $results[[3]]$changes[[1]]
#&gt; $results[[3]]$changes[[1]]$rev
#&gt; [1] &quot;1-08aef850a23f5ff95869c9cf5d9604dc&quot;
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; 
#&gt; $last_seq
#&gt; [1] &quot;3-g1AAAACbeJzLYWBgYMpgTmEQTM4vTc5ISXLIyU9OzMnILy7JAUklMiTV____PyuDOZExFyjAbm5pmmRsaoxNAx5j8liAJEMDkPoPNY0JbFqKhYl5moUhNn1ZAFA4MFE&quot;
#&gt; 
#&gt; $pending
#&gt; [1] 0
</code></pre>

<h3 id="search">Search</h3>

<p>The simplest search just returns the documents.</p>

<pre><code class="language-r">db_query(x, dbname = &quot;cats&quot;, selector = list(`_id` = list(`$gt` = NULL)))$docs
#&gt; [[1]]
#&gt; [[1]]$`_id`
#&gt; [1] &quot;bluecat&quot;
#&gt; 
#&gt; [[1]]$`_rev`
#&gt; [1] &quot;1-41784f190c466d990684003a958c9f39&quot;
#&gt; 
#&gt; [[1]]$name
#&gt; [1] &quot;leo&quot;
#&gt; 
#&gt; [[1]]$color
#&gt; [1] &quot;blue&quot;
#&gt; 
#&gt; [[1]]$furry
#&gt; [1] TRUE
#&gt; 
#&gt; [[1]]$size
#&gt; [1] 1
#&gt; 
#&gt; 
#&gt; [[2]]
#&gt; [[2]]$`_id`
#&gt; [1] &quot;faa356c2302d8c8ac5800effc3000f83&quot;
#&gt; 
#&gt; [[2]]$`_rev`
#&gt; [1] &quot;1-08aef850a23f5ff95869c9cf5d9604dc&quot;
#&gt; 
#&gt; [[2]]$name
#&gt; [1] &quot;samson&quot;
#&gt; 
#&gt; [[2]]$color
#&gt; [1] &quot;red&quot;
#&gt; 
#&gt; [[2]]$furry
#&gt; [1] FALSE
#&gt; 
#&gt; [[2]]$size
#&gt; [1] 3
#&gt; 
#&gt; 
#&gt; [[3]]
#&gt; [[3]]$`_id`
#&gt; [1] &quot;faa356c2302d8c8ac5800effc300131a&quot;
#&gt; 
#&gt; [[3]]$`_rev`
#&gt; [1] &quot;1-73443af61b0149e4c3e138b870e72602&quot;
#&gt; 
#&gt; [[3]]$name
#&gt; [1] &quot;matilda&quot;
#&gt; 
#&gt; [[3]]$color
#&gt; [1] &quot;green&quot;
#&gt; 
#&gt; [[3]]$furry
#&gt; [1] FALSE
#&gt; 
#&gt; [[3]]$size
#&gt; [1] 5
</code></pre>

<p>Search for cats that are red</p>

<pre><code class="language-r">db_query(x, dbname = &quot;cats&quot;, selector = list(color = &quot;red&quot;))$docs
#&gt; [[1]]
#&gt; [[1]]$`_id`
#&gt; [1] &quot;faa356c2302d8c8ac5800effc3000f83&quot;
#&gt; 
#&gt; [[1]]$`_rev`
#&gt; [1] &quot;1-08aef850a23f5ff95869c9cf5d9604dc&quot;
#&gt; 
#&gt; [[1]]$name
#&gt; [1] &quot;samson&quot;
#&gt; 
#&gt; [[1]]$color
#&gt; [1] &quot;red&quot;
#&gt; 
#&gt; [[1]]$furry
#&gt; [1] FALSE
#&gt; 
#&gt; [[1]]$size
#&gt; [1] 3
</code></pre>

<p>Search for cats that are furry</p>

<pre><code class="language-r">db_query(x, dbname = &quot;cats&quot;, selector = list(size = list(`$gt` = 2)))$docs
#&gt; [[1]]
#&gt; [[1]]$`_id`
#&gt; [1] &quot;faa356c2302d8c8ac5800effc3000f83&quot;
#&gt; 
#&gt; [[1]]$`_rev`
#&gt; [1] &quot;1-08aef850a23f5ff95869c9cf5d9604dc&quot;
#&gt; 
#&gt; [[1]]$name
#&gt; [1] &quot;samson&quot;
#&gt; 
#&gt; [[1]]$color
#&gt; [1] &quot;red&quot;
#&gt; 
#&gt; [[1]]$furry
#&gt; [1] FALSE
#&gt; 
#&gt; [[1]]$size
#&gt; [1] 3
#&gt; 
#&gt; 
#&gt; [[2]]
#&gt; [[2]]$`_id`
#&gt; [1] &quot;faa356c2302d8c8ac5800effc300131a&quot;
#&gt; 
#&gt; [[2]]$`_rev`
#&gt; [1] &quot;1-73443af61b0149e4c3e138b870e72602&quot;
#&gt; 
#&gt; [[2]]$name
#&gt; [1] &quot;matilda&quot;
#&gt; 
#&gt; [[2]]$color
#&gt; [1] &quot;green&quot;
#&gt; 
#&gt; [[2]]$furry
#&gt; [1] FALSE
#&gt; 
#&gt; [[2]]$size
#&gt; [1] 5
</code></pre>

<p>Return only certain fields</p>

<pre><code class="language-r">db_query(x, dbname = &quot;cats&quot;,
         selector = list(size = list(`$gt` = 2)),
         fields = c(&quot;name&quot;, &quot;color&quot;))$docs
#&gt; [[1]]
#&gt; [[1]]$name
#&gt; [1] &quot;samson&quot;
#&gt; 
#&gt; [[1]]$color
#&gt; [1] &quot;red&quot;
#&gt; 
#&gt; 
#&gt; [[2]]
#&gt; [[2]]$name
#&gt; [1] &quot;matilda&quot;
#&gt; 
#&gt; [[2]]$color
#&gt; [1] &quot;green&quot;
</code></pre>

<h3 id="citing">Citing</h3>

<blockquote>
<p>Scott Chamberlain (2016). sofa: Connector to &lsquo;CouchDB&rsquo;. R package version 0.2.0. <a href="https://github.com/ropensci/sofa">https://github.com/ropensci/sofa</a></p>
</blockquote>

<h3 id="license-and-bugs">License and bugs</h3>

<ul>
<li>License: <a href="http://opensource.org/licenses/MIT">MIT</a></li>
<li>Report bugs at <a href="https://github.com/ropensci/sofa/issues?state=open">our GitHub repo for sofa</a></li>
</ul>

<p><a href="#top">Back to top</a></p>

                    </article>
                </div>

                </div>
            </div>
        </div>
    </article>


    <div id="footer">
        <div class="container">
            <div class="row start">
                <div class="col-1 col-1-3 top-8">
                    <img src="/img/icon_short_white.svg" />
                </div>

                <div class="col-9 col-offset-2 top-10 bottom-8">
                    <div class="row between">
                        <div class="col-2 col-1-3">
                            <a href="http://github.com/ropensci" target="_blank"><div class="icon icon-github"></div></a>
                            <a href="http://twitter.com/ropensci" target="_blank"><div class="icon icon-twitter"></div></a>
                            <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon icon-vimeo"></div></a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Info</h5>
                                <li><a href="/about">Mission</a></li>
                                <li><a href="/about#team">Team</a></li>
                                <li><a href="/about#collaborators">Collaborators</a></li>
                                <li><a href="/careers">Careers</a></li>

                            </ul>
                        </div>

                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Work</h5>
                                <li><a href="/packages/">Packages</a></li>
                                <li><a href="/blog/">Blog</a></li>
                                <li><a href="/technotes/">Tech Notes</a></li>
                                <li><a href="/tutorials/">Tutorials</a></li>
                                <li><a href="/usecases/">Use Cases</a></li>
                                <li><a href="/resources/">More Resources</a></li>
                            </ul>
                        </div>
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Participate</h5>
                                <li><a href="/contact.html">Contact us</a></li>
                                <li><a href="/community/">Community</a></li>
                                <li><a href="http://onboarding.ropensci.org/">Contribute software</a></li>
                                <li><a href="http://unconf17.ropensci.org/">Unconference</a></li>
                                <li><a href="/coc">Code of conduct</a></li>
                                <li><a href="/donate/">Donate</a></li>
                            </ul>
                        </div>
                        <div class="col-4 top-8 bottom-8">
                            <h5 class="bottom-2"></h5>

                            <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                            <a href="http://numfocus.org" target="_blank"><img src="img/numfocus.png"></a>
                            <br>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 top-8 bottom-9 divider">
                    <p class="top-9">Except where otherwise noted, content on this site is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY license</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>




    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    

    
    <script type="text/javascript" src="/js/highlight.pack.js"></script>
    <script type="text/javascript">
        hljs.initHighlightingOnLoad();
    </script>



</body>
</html>
