<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>rOpenSci | rotl tutorial</title>

     
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>

    <script type="text/javascript">
    hljs.configure({languages: []});
    hljs.initHighlightingOnLoad();
    </script>
    <link rel="stylesheet" type="text/css" href="/css/style-new.css" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#4b8add">
<meta name="theme-color" content="#4b8add">


    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

    
    <div id="header">
        <div class="container">
            <div class="row center-m">
                
                <div class="col-1">
                    <a href="/index.html"><img src="/img/icon_lettering_white.svg" /></a>
                </div>
                
                
                <nav class="col-6 col-offset-4 top-3">
                    <ul class="row between">
						<li><a href="/about/">About</a></li>
                        <li><a href="/blog/">Blog</a></li>
                        <li><a href="/packages/">Packages</a></li>
                        <li><a href="/community/">Community</a></li>
                        <li><a href="http://discuss.ropensci.org/" target="_blank">Discuss</a></li>

                    </ul>
                </nav>
                
            </div>
        </div>
    </div>



    <article>
        <div class="container top-20">
            
            <div class="row centered">
                
                <div class="col-7 bottom-20 maintext">
                    <h1>rotl tutorial</h1>
                    <br>
                    <h4><small style="color:grey">for v3.0.3</small></h4>
                    <br>

                    <article>
                    

<p><code>rotl</code> provides an interface to the Open Tree of Life (OTL) API and allows users
to query the API, retrieve parts of the Tree of Life and integrate these parts
with other R packages.</p>

<p>The OTL API provides services to access:</p>

<ul>
<li>the <strong>Tree of Life</strong> a.k.a. TOL (the synthetic tree): a single draft tree that is
a combination of <strong>the OTL taxonomy</strong> and the <strong>source trees</strong> (studies)</li>
<li>the <strong>Taxonomic name resolution services</strong> a.k.a. TNRS: the methods for
resolving taxonomic names to the internal identifiers used by the TOL and the
GOL (the <code>ott ids</code>).</li>
<li>the <strong>Taxonomy</strong> a.k.a. OTT (for Open Tree Taxonomy): which represents the
synthesis of the different taxonomies used as a backbone of the TOL when no
studies are available.</li>
<li>the <strong>Studies</strong> containing the source trees used to build the TOL, and
extracted from the scientific literature.</li>
</ul>

<p>In <code>rotl</code>, each of these services correspond to functions with different
prefixes:</p>

<table>
<thead>
<tr>
<th>Service</th>
<th><code>rotl</code> prefix</th>
</tr>
</thead>

<tbody>
<tr>
<td>Tree of Life</td>
<td><code>tol_</code></td>
</tr>

<tr>
<td>TNRS</td>
<td><code>tnrs_</code></td>
</tr>

<tr>
<td>Taxonomy</td>
<td><code>taxonomy_</code></td>
</tr>

<tr>
<td>Studies</td>
<td><code>studies_</code></td>
</tr>
</tbody>
</table>

<p><code>rotl</code> also provides a few other functions and methods that can be used to
extract relevant information from the objects returned by these functions.</p>

<p><section id="installation"></p>

<h2 id="installation">Installation</h2>

<pre><code class="language-r">install.packages(&quot;rotl&quot;)
</code></pre>

<p>Or development version from GitHub</p>

<pre><code class="language-r">install.packages(&quot;devtools&quot;)
devtools::install_github(&quot;ropensci/rotl&quot;)
</code></pre>

<pre><code class="language-r">library(&quot;rotl&quot;)
</code></pre>

<p><section id="usage"></p>

<h2 id="usage">Usage</h2>

<h3 id="demonstration-of-a-basic-workflow">Demonstration of a basic workflow</h3>

<p>The most common use for <code>rotl</code> is probably to start from a list of species and
get the relevant parts of the tree for these species. This is a two step
process:</p>

<ol>
<li>the species names need to be matched to their <code>ott_id</code> (the Open Tree
Taxonomy identifiers) using the Taxonomic name resolution services (TNRS)</li>
<li>these <code>ott_id</code> will then be used to retrieve the relevant parts of the Tree
of Life.</li>
</ol>

<h4 id="step-1-matching-taxonomy-to-the-ott-id">Step 1: Matching taxonomy to the <code>ott_id</code></h4>

<p>Let&rsquo;s start by doing a search on a diverse group of taxa: a tree frog (genus
<em>Hyla</em>), a fish (genus <em>Salmo</em>), a sea urchin (genus <em>Diadema</em>), and a nautilus
(genus <em>Nautilus</em>).</p>

<pre><code class="language-r">taxa &lt;- c(&quot;Hyla&quot;, &quot;Salmo&quot;, &quot;Diadema&quot;, &quot;Nautilus&quot;)
resolved_names &lt;- tnrs_match_names(taxa)
</code></pre>

<p>It&rsquo;s always a good idea to check that the resolved names match what you
intended:</p>

<table>
<thead>
<tr>
<th align="left">search_string</th>
<th align="left">unique_name</th>
<th align="left">approximate_match</th>
<th align="left">ott_id</th>
<th align="left">is_synonym</th>
<th align="left">flags</th>
<th align="left">number_matches</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">hyla</td>
<td align="left">Hyla</td>
<td align="left">FALSE</td>
<td align="left">1062216</td>
<td align="left">FALSE</td>
<td align="left"></td>
<td align="left">1</td>
</tr>

<tr>
<td align="left">salmo</td>
<td align="left">Salmo</td>
<td align="left">FALSE</td>
<td align="left">982359</td>
<td align="left">FALSE</td>
<td align="left"></td>
<td align="left">1</td>
</tr>

<tr>
<td align="left">diadema</td>
<td align="left">Diadema (genus in Nucletmycea)</td>
<td align="left">FALSE</td>
<td align="left">4930522</td>
<td align="left">FALSE</td>
<td align="left"></td>
<td align="left">5</td>
</tr>

<tr>
<td align="left">nautilus</td>
<td align="left">Nautilus</td>
<td align="left">FALSE</td>
<td align="left">616358</td>
<td align="left">FALSE</td>
<td align="left"></td>
<td align="left">1</td>
</tr>
</tbody>
</table>

<p>The column <code>unique_name</code> sometimes indicates the higher taxonomic level
associated with the name. The column <code>number_matches</code> indicates the number of
<code>ott_id</code> that corresponds to a given name. In this example, our search on
<em>Diadema</em> returns 2 matches, and the one returned by default is indeed the sea
urchin that we want for our query. The argument <code>context_name</code> allows you to
limit the taxonomic scope of your search. <em>Diadema</em> is also the genus name of a
fungus. To ensure that our search is limited to animal names, we could do:</p>

<pre><code class="language-r">resolved_names &lt;- tnrs_match_names(taxa, context_name = &quot;Animals&quot;)
</code></pre>

<p>If you are trying to build a tree with deeply divergent taxa that the argument
<code>context_name</code> cannot fix, see &ldquo;How to change the ott ids assigned to my taxa?&rdquo;
in the FAQ below.</p>

<h4 id="step-2-getting-the-tree-corresponding-to-our-taxa">Step 2: Getting the tree corresponding to our taxa</h4>

<p>Now that we have the correct <code>ott_id</code> for our taxa, we can ask for the tree
using the <code>tol_induced_subtree()</code> function. By default, the object returned by
<code>tol_induced_subtree</code> is a phylo object (from the
<a href="http://cran.r-project.org/package=ape">ape</a> package), so we can plot it
directly.</p>

<pre><code class="language-r">my_tree &lt;- tol_induced_subtree(ott_ids = resolved_names$ott_id)
plot(my_tree, no.margin=TRUE)
</code></pre>

<p><img src="/img/tutorial-images/rotl/unnamed-chunk-7-1.png" alt="plot of chunk unnamed-chunk-7" /></p>

<h3 id="get-tree-for-a-particular-taxonomic-group">Get tree for a particular taxonomic group</h3>

<p>If you are looking to get the tree for a particular taxonomic group, you need to
first identify it by its node id or ott id, and then use the <code>tol_subtree()</code>
function:</p>

<pre><code class="language-r">mono_id &lt;- tnrs_match_names(&quot;Monotremes&quot;)
mono_tree &lt;- tol_subtree(ott_id = mono_id$ott_id[1])
plot(mono_tree)
</code></pre>

<p><img src="/img/tutorial-images/rotl/unnamed-chunk-8-1.png" alt="plot of chunk unnamed-chunk-8" /></p>

<h3 id="find-trees-from-studies-focused-on-my-favourite-taxa">Find trees from studies focused on my favourite taxa</h3>

<p>The function <code>studies_find_trees()</code> allows the user to search for studies
matching a specific criteria. The function <code>studies_properties()</code> returns the
list of properties that can be used in the search.</p>

<pre><code class="language-r">furry_studies &lt;- studies_find_studies(property=&quot;ot:focalCladeOTTTaxonName&quot;, value=&quot;Mammalia&quot;)
furry_ids &lt;- furry_studies$study_ids
</code></pre>

<p>Now that we know the <code>study_id</code>, we can ask for the meta data information
associated with this study:</p>

<pre><code class="language-r">furry_meta &lt;- get_study_meta(&quot;pg_2550&quot;)
get_publication(furry_meta)     ## The citation for the source of the study
#&gt; [1] &quot;O'Leary, Maureen A., Marc Allard, Michael J. Novacek, Jin Meng, and John Gatesy. 2004. \&quot;Building the mammalian sector of the tree of life: Combining different data and a discussion of divergence times for placental mammals.\&quot; In: Cracraft J., &amp; Donoghue M., eds. Assembling the Tree of Life. pp. 490-516. Oxford, United Kingdom, Oxford University Press.&quot;
#&gt; attr(,&quot;DOI&quot;)
#&gt; [1] &quot;&quot;
get_tree_ids(furry_meta)        ## This study has 10 trees associated with it
#&gt;  [1] &quot;tree5513&quot; &quot;tree5515&quot; &quot;tree5516&quot; &quot;tree5517&quot; &quot;tree5518&quot; &quot;tree5519&quot;
#&gt;  [7] &quot;tree5520&quot; &quot;tree5521&quot; &quot;tree5522&quot; &quot;tree5523&quot;
candidate_for_synth(furry_meta) ## None of these trees are yet included in the OTL
#&gt; NULL
</code></pre>

<p>Using <code>get_study(&quot;pg_2550&quot;)</code> would returns a <code>multiPhylo</code> object (default) with
all the trees associated with this particular study, while
<code>get_study_tree(&quot;pg_2550&quot;, &quot;tree5513&quot;)</code> would return one of these trees.</p>

<p><section id="citing"></p>

<h2 id="citing">Citing</h2>

<p>To cite <code>rotl</code> in publications use:</p>

<p><br></p>

<blockquote>
<p>Michonneau, F., Brown, J. W. and Winter, D. J. (2016), rotl: an R
  package to interact with the Open Tree of Life data.  Methods Ecol
  Evol. 7(12):1476-1481. doi:10.<sup>1111</sup>&frasl;<sub>2041</sub>-210X.12593</p>
</blockquote>

<p><section id="license_bugs"></p>

<h2 id="license-and-bugs">License and bugs</h2>

<ul>
<li>License: <a href="https://opensource.org/licenses/BSD-2-Clause">BSD_2_clause</a></li>
<li>Report bugs at <a href="https://github.com/ropensci/rotl/issues?state=open">our Github repo for rotl</a></li>
</ul>

<p><a href="#top">Back to top</a></p>

                    </article>
                </div>

                </div>
            </div>
        </div>
    </article>


    <div id="footer">
        <div class="container">
            <div class="row start">
                <div class="col-1 col-1-3 top-8">
                    <img src="/img/icon_short_white.svg" />
                </div>

                <div class="col-9 col-offset-2 top-10 bottom-8">
                    <div class="row between">
                        <div class="col-2 col-1-3">
                            <a href="http://github.com/ropensci" target="_blank"><div class="icon icon-github"></div></a>
                            <a href="http://twitter.com/ropensci" target="_blank"><div class="icon icon-twitter"></div></a>
                            <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon icon-vimeo"></div></a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Info</h5>
                                <li><a href="/about">Mission</a></li>
                                <li><a href="/about#team">Team</a></li>
                                <li><a href="/about#collaborators">Collaborators</a></li>
                                <li><a href="/careers">Careers</a></li>

                            </ul>
                        </div>

                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Work</h5>
                                <li><a href="/packages/">Packages</a></li>
                                <li><a href="/blog/">Blog</a></li>
                                <li><a href="/technotes/">Tech Notes</a></li>
                                <li><a href="/tutorials/">Tutorials</a></li>
                                <li><a href="/usecases/">Use Cases</a></li>
                                <li><a href="/resources/">More Resources</a></li>
                            </ul>
                        </div>
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Participate</h5>
                                <li><a href="/contact.html">Contact us</a></li>
                                <li><a href="/community/">Community</a></li>
                                <li><a href="http://onboarding.ropensci.org/">Contribute software</a></li>
                                <li><a href="http://unconf17.ropensci.org/">Unconference</a></li>
                                <li><a href="/coc">Code of conduct</a></li>
                                <li><a href="/donate/">Donate</a></li>
                            </ul>
                        </div>
                        <div class="col-4 top-8 bottom-8">
                            <h5 class="bottom-2"></h5>

                            <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                            <a href="http://numfocus.org" target="_blank"><img src="img/numfocus.png"></a>
                            <br>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 top-8 bottom-9 divider">
                    <p class="top-9">Except where otherwise noted, content on this site is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY license</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>




    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    

    
    <script type="text/javascript" src="/js/highlight.pack.js"></script>
    <script type="text/javascript">
        hljs.initHighlightingOnLoad();
    </script>



</body>
</html>
