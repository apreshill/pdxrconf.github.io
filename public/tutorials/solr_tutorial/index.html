<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>rOpenSci | solr tutorial</title>

     
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>

    <script type="text/javascript">
    hljs.configure({languages: []});
    hljs.initHighlightingOnLoad();
    </script>
    <link rel="stylesheet" type="text/css" href="/css/style-new.css" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#4b8add">
<meta name="theme-color" content="#4b8add">


    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

    
    <div id="header">
        <div class="container">
            <div class="row center-m">
                
                <div class="col-1">
                    <a href="/index.html"><img src="/img/icon_lettering_white.svg" /></a>
                </div>
                
                
                <nav class="col-6 col-offset-4 top-3">
                    <ul class="row between">
						<li><a href="/about/">About</a></li>
                        <li><a href="/blog/">Blog</a></li>
                        <li><a href="/packages/">Packages</a></li>
                        <li><a href="/community/">Community</a></li>
                        <li><a href="http://discuss.ropensci.org/" target="_blank">Discuss</a></li>

                    </ul>
                </nav>
                
            </div>
        </div>
    </div>



    <article>
        <div class="container top-20">
            
            <div class="row centered">
                
                <div class="col-7 bottom-20 maintext">
                    <h1>solr tutorial</h1>
                    <br>
                    <h4><small style="color:grey">for v0.1.6</small></h4>
                    <br>

                    <article>
                    

<blockquote>
<p>This package has been rebooted as <code>solrium</code> - check out the tutorial at <a href="https://ropensci.org/tutorials/solrium_tutorial.html">https://ropensci.org/tutorials/solrium_tutorial.html</a></p>
</blockquote>

<p><section id="installation"></p>

<h2 id="installation">Installation</h2>

<p>More stable version from CRAN</p>

<pre><code class="language-r">install.packages(&quot;solr&quot;)
</code></pre>

<p>Development version from Github</p>

<pre><code class="language-r">if (!require(&quot;devtools&quot;)) install.packages(&quot;devtools&quot;)
devtools::install_github(&quot;ropensci/solr&quot;)
</code></pre>

<p>Load</p>

<pre><code class="language-r">library(&quot;solr&quot;)
</code></pre>

<p><section id="usage"></p>

<h2 id="usage">Usage</h2>

<p>The <code>solr</code> package is a general purpose R interface to <a href="http://lucene.apache.org/solr/">Solr</a></p>

<p>This package only deals with exracting data from a Solr endpoint, not writing data (pull request or holla if you&rsquo;re interested in writing solr data).</p>

<h3 id="solr-info">Solr info</h3>

<ul>
<li><a href="http://lucene.apache.org/solr/">Solr home page</a></li>
<li><a href="http://wiki.apache.org/solr/HighlightingParameters">Highlighting help</a></li>
<li><a href="http://wiki.apache.org/solr/SimpleFacetParameters">Faceting help</a></li>
<li><a href="http://ramlev.dk/blog/2012/06/02/install-apache-solr-on-your-mac/">Installing Solr on Mac using homebrew</a></li>
<li><a href="http://risnandar.wordpress.com/2013/09/08/how-to-install-and-setup-apache-lucene-solr-in-osx/">Install and Setup SOLR in OSX, including running Solr</a></li>
</ul>

<h3 id="quick-start">Quick start</h3>

<p><strong>Define stuff</strong> Your base url and a key (if needed). This example should work. You do need to pass a key to the Public Library of Science search API, but it apparently doesn&rsquo;t need to be a real one.</p>

<pre><code class="language-r">url &lt;- 'http://api.plos.org/search'
key &lt;- 'key'
</code></pre>

<p><strong>Search</strong></p>

<pre><code class="language-r">solr_search(q='*:*', rows=2, fl='id', base=url, key=key)
</code></pre>

<pre><code>#&gt;                                   id
#&gt; 1       10.1371/journal.pone.0107420
#&gt; 2 10.1371/journal.pone.0107420/title
</code></pre>

<p><strong>Facet</strong></p>

<pre><code class="language-r">solr_facet(q='*:*', facet.field='journal', facet.query=c('cell','bird'), base=url, key=key)
</code></pre>

<pre><code>#&gt; $facet_queries
#&gt;   term  value
#&gt; 1 cell 133052
#&gt; 2 bird  13598
#&gt;
#&gt; $facet_fields
#&gt; $facet_fields$journal
#&gt;                                 X1      X2
#&gt; 1                         plos one 1285831
#&gt; 2                    plos genetics   50706
#&gt; 3                   plos pathogens   44134
#&gt; 4       plos computational biology   37646
#&gt; 5 plos neglected tropical diseases   35979
#&gt; 6                     plos biology   29392
#&gt; 7                    plos medicine   20335
#&gt; 8             plos clinical trials     521
#&gt; 9                     plos medicin       9
#&gt;
#&gt;
#&gt; $facet_dates
#&gt; NULL
#&gt;
#&gt; $facet_ranges
#&gt; NULL
</code></pre>

<p><strong>Highlight</strong></p>

<pre><code class="language-r">solr_highlight(q='alcohol', hl.fl = 'abstract', rows=2, base = url, key=key)
</code></pre>

<pre><code>#&gt; $`10.1371/journal.pmed.0040151`
#&gt; $`10.1371/journal.pmed.0040151`$abstract
#&gt; [1] &quot;Background: &lt;em&gt;Alcohol&lt;/em&gt; consumption causes an estimated 4% of the global disease burden, prompting&quot;
#&gt;
#&gt;
#&gt; $`10.1371/journal.pone.0027752`
#&gt; $`10.1371/journal.pone.0027752`$abstract
#&gt; [1] &quot;Background: The negative influences of &lt;em&gt;alcohol&lt;/em&gt; on TB management with regard to delays in seeking&quot;
</code></pre>

<p><strong>Stats</strong></p>

<pre><code class="language-r">out &lt;- solr_stats(q='ecology', stats.field=c('counter_total_all','alm_twitterCount'), stats.facet=c('journal','volume'), base=url, key=key)
</code></pre>

<pre><code class="language-r">out$data
</code></pre>

<pre><code>#&gt;                   min    max count missing       sum sumOfSquares
#&gt; counter_total_all   0 381005 32852       0 149031058 3.400519e+12
#&gt; alm_twitterCount    0   1763 32852       0    185772 3.565201e+07
#&gt;                          mean     stddev
#&gt; counter_total_all 4536.437903 9106.78332
#&gt; alm_twitterCount     5.654816   32.45437
</code></pre>

<pre><code class="language-r">out$facet
</code></pre>

<pre><code>#&gt; $counter_total_all
#&gt; $counter_total_all$volume
#&gt;     min    max count missing      sum sumOfSquares      mean    stddev
#&gt; 1     0 171524  2103       0  3835629  70357145667  1823.884  5490.299
#&gt; 2     0 110768   167       0  1230491  27037286881  7368.210 10404.694
#&gt; 3  2148  75942    72       0   772327  16099354117 10726.764 10491.301
#&gt; 4  1054  17107    34       0   200231   1660929909  5889.147  3820.757
#&gt; 5  1894 187549    81       0  1537428  91933035658 18980.593 28007.084
#&gt; 6  1715 120974   482       0  5948960 169424242112 12342.241 14127.482
#&gt; 7  1366 129059   741       0  7868119 195614871613 10618.244 12306.297
#&gt; 8   704 366145  1010       0  9896935 353256010661  9798.946 15937.082
#&gt; 9   103 120116  1539       0 12404305 231308647989  8059.977  9240.685
#&gt; 10   72 253313  2948       0 18225649 347627981895  6182.378  8928.896
#&gt; 11   51 184534  4825       0 25034662 405690249482  5188.531  7561.209
#&gt; 12   17 381005  6360       0 27474658 569252540142  4319.915  8417.517
#&gt; 13   42 308057  6620       0 22228580 679102577074  3357.792  9556.281
#&gt; 14    0 190562  5870       0 12373084 242153753584  2107.851  6067.619
#&gt;    facet_field
#&gt; 1           11
#&gt; 2           12
#&gt; 3           13
#&gt; 4           14
#&gt; 5            1
#&gt; 6            2
#&gt; 7            3
#&gt; 8            4
#&gt; 9            5
#&gt; 10           6
#&gt; 11           7
#&gt; 12           8
#&gt; 13           9
#&gt; 14          10
#&gt;
#&gt; $counter_total_all$journal
#&gt;    min    max count missing       sum sumOfSquares      mean    stddev
#&gt; 1  704 120974   246       0   4214716 1.564771e+11 17132.992 18545.739
#&gt; 2 1054 276407   909       0  14517422 5.853448e+11 15970.761 19730.857
#&gt; 3 8518  13973     2       0     22491 2.678011e+08 11245.500  3857.267
#&gt; 4    0 381005 27131       0 101671435 2.102781e+12  3747.427  7966.421
#&gt; 5 1219  65875   609       0   4973930 7.003314e+10  8167.373  6954.883
#&gt; 6  475  80210   779       0   6583271 9.726579e+10  8450.926  7315.077
#&gt; 7    0 216948  1318       0   6245038 1.075082e+11  4738.269  7691.744
#&gt; 8    0 303724   607       0   4418575 1.542870e+11  7279.366 14195.857
#&gt;                        facet_field
#&gt; 1                    plos medicine
#&gt; 2                     plos biology
#&gt; 3             plos clinical trials
#&gt; 4                         plos one
#&gt; 5                   plos pathogens
#&gt; 6                    plos genetics
#&gt; 7 plos neglected tropical diseases
#&gt; 8       plos computational biology
#&gt;
#&gt;
#&gt; $alm_twitterCount
#&gt; $alm_twitterCount$volume
#&gt;    min  max count missing   sum sumOfSquares       mean     stddev
#&gt; 1    0 1763  2103       0 22076      4662064 10.4973847  45.909374
#&gt; 2    0 1133   167       0  7738      2167192 46.3353293 104.381403
#&gt; 3    0  360    72       0  3852       638160 53.5000000  78.010292
#&gt; 4    0  368    34       0  3138       609804 92.2941176  98.501663
#&gt; 5    0   42    81       0   177         5001  2.1851852   7.594589
#&gt; 6    0  108   482       0   783        32997  1.6244813   8.121355
#&gt; 7    0   49   741       0   714        12896  0.9635628   4.061689
#&gt; 8    0  242  1010       0  1091        78313  1.0801980   8.743368
#&gt; 9    0  129  1539       0  1985        96697  1.2897986   7.823506
#&gt; 10   0  892  2948       0  4462      1290514  1.5135685  20.871417
#&gt; 11   0  822  4825       0 19805      2066673  4.1046632  20.287017
#&gt; 12   0 1561  6360       0 36483      6845473  5.7363208  32.304658
#&gt; 13   0 1581  6620       0 50448     13527984  7.6205438  44.561524
#&gt; 14   0  943  5870       0 33020      3618240  5.6252129  24.183710
#&gt;    facet_field
#&gt; 1           11
#&gt; 2           12
#&gt; 3           13
#&gt; 4           14
#&gt; 5            1
#&gt; 6            2
#&gt; 7            3
#&gt; 8            4
#&gt; 9            5
#&gt; 10           6
#&gt; 11           7
#&gt; 12           8
#&gt; 13           9
#&gt; 14          10
#&gt;
#&gt; $alm_twitterCount$journal
#&gt;   min  max count missing    sum sumOfSquares      mean   stddev
#&gt; 1   0  784   246       0   4375      1044519 17.784553 62.81530
#&gt; 2   0 1763   909       0  19658      7025376 21.625963 85.25844
#&gt; 3   0    3     2       0      3            9  1.500000  2.12132
#&gt; 4   0 1581 27131       0 135040     25380518  4.977332 30.17847
#&gt; 5   0  133   609       0   4496       170710  7.382594 15.03930
#&gt; 6   0  181   779       0   4835       181223  6.206675 13.94138
#&gt; 7   0  892  1318       0   5848      1122858  4.437026 28.85976
#&gt; 8   0  289   607       0   4643       296565  7.649094 20.75514
#&gt;                        facet_field
#&gt; 1                    plos medicine
#&gt; 2                     plos biology
#&gt; 3             plos clinical trials
#&gt; 4                         plos one
#&gt; 5                   plos pathogens
#&gt; 6                    plos genetics
#&gt; 7 plos neglected tropical diseases
#&gt; 8       plos computational biology
</code></pre>

<p><strong>More like this</strong></p>

<p><code>solr_mlt</code> is a function to return similar documents to the one</p>

<pre><code class="language-r">out &lt;- solr_mlt(q='title:&quot;ecology&quot; AND body:&quot;cell&quot;', mlt.fl='title', mlt.mindf=1, mlt.mintf=1, fl='counter_total_all', rows=5, base=url, key=key)
out$docs
</code></pre>

<pre><code>#&gt;                             id counter_total_all
#&gt; 1 10.1371/journal.pbio.1001805             17665
#&gt; 2 10.1371/journal.pbio.0020440             24041
#&gt; 3 10.1371/journal.pone.0087217              6336
#&gt; 4 10.1371/journal.pbio.1002191             14565
#&gt; 5 10.1371/journal.pone.0040117              4613
</code></pre>

<pre><code class="language-r">out$mlt
</code></pre>

<pre><code>#&gt; $`10.1371/journal.pbio.1001805`
#&gt;                             id counter_total_all
#&gt; 1 10.1371/journal.pone.0082578              2270
#&gt; 2 10.1371/journal.pone.0098876              2603
#&gt; 3 10.1371/journal.pone.0102159              1244
#&gt; 4 10.1371/journal.pcbi.1003408              7336
#&gt; 5 10.1371/journal.pone.0076063              2971
#&gt;
#&gt; $`10.1371/journal.pbio.0020440`
#&gt;                             id counter_total_all
#&gt; 1 10.1371/journal.pone.0035964              5920
#&gt; 2 10.1371/journal.pone.0102679              3340
#&gt; 3 10.1371/journal.pone.0003259              2882
#&gt; 4 10.1371/journal.pone.0101568              2823
#&gt; 5 10.1371/journal.pntd.0003377              3507
#&gt;
#&gt; $`10.1371/journal.pone.0087217`
#&gt;                             id counter_total_all
#&gt; 1 10.1371/journal.pone.0131665               522
#&gt; 2 10.1371/journal.pcbi.0020092             20087
#&gt; 3 10.1371/journal.pone.0133941               595
#&gt; 4 10.1371/journal.pone.0123774              1095
#&gt; 5 10.1371/journal.pone.0140306               370
#&gt;
#&gt; $`10.1371/journal.pbio.1002191`
#&gt;                             id counter_total_all
#&gt; 1 10.1371/journal.pbio.1002232              2148
#&gt; 2 10.1371/journal.pone.0131700              1121
#&gt; 3 10.1371/journal.pone.0070448              1669
#&gt; 4 10.1371/journal.pone.0044766              2349
#&gt; 5 10.1371/journal.pone.0062824              2732
#&gt;
#&gt; $`10.1371/journal.pone.0040117`
#&gt;                             id counter_total_all
#&gt; 1 10.1371/journal.pone.0069352              2940
#&gt; 2 10.1371/journal.pone.0148280               710
#&gt; 3 10.1371/journal.pone.0014065              5915
#&gt; 4 10.1371/journal.pone.0035502              4139
#&gt; 5 10.1371/journal.pone.0078369              3548
</code></pre>

<p><strong>Parsing</strong></p>

<p><code>solr_parse</code> is a general purpose parser function with extension methods <code>solr_parse.sr_search</code>, <code>solr_parse.sr_facet</code>, and <code>solr_parse.sr_high</code>, for parsing <code>solr_search</code>, <code>solr_facet</code>, and <code>solr_highlight</code> function output, respectively. <code>solr_parse</code> is used internally within those three functions (<code>solr_search</code>, <code>solr_facet</code>, <code>solr_highlight</code>) to do parsing. You can optionally get back raw <code>json</code> or <code>xml</code> from <code>solr_search</code>, <code>solr_facet</code>, and <code>solr_highlight</code> setting parameter <code>raw=TRUE</code>, and then parsing after the fact with <code>solr_parse</code>. All you need to know is <code>solr_parse</code> can parse</p>

<p>For example:</p>

<pre><code class="language-r">(out &lt;- solr_highlight(q='alcohol', hl.fl = 'abstract', rows=2, base = url, key=key, raw=TRUE))
</code></pre>

<pre><code>#&gt; [1] &quot;{\&quot;response\&quot;:{\&quot;numFound\&quot;:21115,\&quot;start\&quot;:0,\&quot;docs\&quot;:[{},{}]},\&quot;highlighting\&quot;:{\&quot;10.1371/journal.pmed.0040151\&quot;:{\&quot;abstract\&quot;:[\&quot;Background: &lt;em&gt;Alcohol&lt;/em&gt; consumption causes an estimated 4% of the global disease burden, prompting\&quot;]},\&quot;10.1371/journal.pone.0027752\&quot;:{\&quot;abstract\&quot;:[\&quot;Background: The negative influences of &lt;em&gt;alcohol&lt;/em&gt; on TB management with regard to delays in seeking\&quot;]}}}\n&quot;
#&gt; attr(,&quot;class&quot;)
#&gt; [1] &quot;sr_high&quot;
#&gt; attr(,&quot;wt&quot;)
#&gt; [1] &quot;json&quot;
</code></pre>

<p>Then parse</p>

<pre><code class="language-r">solr_parse(out, 'df')
</code></pre>

<pre><code>#&gt;                          names
#&gt; 1 10.1371/journal.pmed.0040151
#&gt; 2 10.1371/journal.pone.0027752
#&gt;                                                                                                    abstract
#&gt; 1   Background: &lt;em&gt;Alcohol&lt;/em&gt; consumption causes an estimated 4% of the global disease burden, prompting
#&gt; 2 Background: The negative influences of &lt;em&gt;alcohol&lt;/em&gt; on TB management with regard to delays in seeking
</code></pre>

<p><strong>Using specific data sources</strong></p>

<p><em>USGS BISON service</em></p>

<p>The occurrences service</p>

<pre><code class="language-r">url &lt;- &quot;http://bisonapi.usgs.ornl.gov/solr/occurrences/select&quot;
solr_search(q='*:*', fl=c('decimalLatitude','decimalLongitude','scientificName'), base=url)
</code></pre>

<pre><code>#&gt;    decimalLongitude decimalLatitude        scientificName
#&gt; 1          -98.2376         29.5502   Nyctanassa violacea
#&gt; 2          -98.2376         29.5502 Myiarchus cinerascens
#&gt; 3          -98.2376         29.5502  Melanerpes aurifrons
#&gt; 4          -98.2376         29.5502  Melanerpes aurifrons
#&gt; 5          -98.2376         29.5502     Mimus polyglottos
#&gt; 6          -98.2376         29.5502        Molothrus ater
#&gt; 7          -98.2376         29.5502     Mimus polyglottos
#&gt; 8          -98.2376         29.5502    Oreothlypis celata
#&gt; 9          -98.2376         29.5502     Megaceryle alcyon
#&gt; 10         -98.2376         29.5502        Molothrus ater
</code></pre>

<p>The species names service</p>

<pre><code class="language-r">url &lt;- &quot;http://bisonapi.usgs.ornl.gov/solr/scientificName/select&quot;
out &lt;- solr_search(q='*:*', base=url, raw=TRUE)
solr_parse(out, &quot;list&quot;)$response$docs[1:3]
</code></pre>

<pre><code>#&gt; [[1]]
#&gt; [[1]]$scientificName
#&gt; [1] &quot;Catocala editha&quot;
#&gt;
#&gt; [[1]]$`_version_`
#&gt; [1] 1.518645e+18
#&gt;
#&gt;
#&gt; [[2]]
#&gt; [[2]]$scientificName
#&gt; [1] &quot;Dictyopteris polypodioides&quot;
#&gt;
#&gt; [[2]]$`_version_`
#&gt; [1] 1.518645e+18
#&gt;
#&gt;
#&gt; [[3]]
#&gt; [[3]]$scientificName
#&gt; [1] &quot;Lonicera iberica&quot;
#&gt;
#&gt; [[3]]$`_version_`
#&gt; [1] 1.518645e+18
</code></pre>

<p>Sweet!  Love me some <code>solr</code></p>

<p><section id="citing"></p>

<h2 id="citing">Citing</h2>

<p>To cite <code>solr</code> in publications use:</p>

<p><br></p>

<blockquote>
<p>Scott Chamberlain (2016). solr: General purpose R interface to Solr. R package version 0.1.6. <a href="http://CRAN.R-project.org/package=solr">http://CRAN.R-project.org/package=solr</a></p>
</blockquote>

<p><section id="license_bugs"></p>

<h2 id="license-and-bugs">License and bugs</h2>

<ul>
<li>License: <a href="http://opensource.org/licenses/MIT">MIT</a></li>
<li>Report bugs at <a href="https://github.com/solr/rgauges/issues?state=open">our Github repo for solr</a></li>
</ul>

<p><a href="#top">Back to top</a></p>

                    </article>
                </div>

                </div>
            </div>
        </div>
    </article>


    <div id="footer">
        <div class="container">
            <div class="row start">
                <div class="col-1 col-1-3 top-8">
                    <img src="/img/icon_short_white.svg" />
                </div>

                <div class="col-9 col-offset-2 top-10 bottom-8">
                    <div class="row between">
                        <div class="col-2 col-1-3">
                            <a href="http://github.com/ropensci" target="_blank"><div class="icon icon-github"></div></a>
                            <a href="http://twitter.com/ropensci" target="_blank"><div class="icon icon-twitter"></div></a>
                            <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon icon-vimeo"></div></a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Info</h5>
                                <li><a href="/about">Mission</a></li>
                                <li><a href="/about#team">Team</a></li>
                                <li><a href="/about#collaborators">Collaborators</a></li>
                                <li><a href="/careers">Careers</a></li>

                            </ul>
                        </div>

                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Work</h5>
                                <li><a href="/packages/">Packages</a></li>
                                <li><a href="/blog/">Blog</a></li>
                                <li><a href="/technotes/">Tech Notes</a></li>
                                <li><a href="/tutorials/">Tutorials</a></li>
                                <li><a href="/usecases/">Use Cases</a></li>
                                <li><a href="/resources/">More Resources</a></li>
                            </ul>
                        </div>
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Participate</h5>
                                <li><a href="/contact.html">Contact us</a></li>
                                <li><a href="/community/">Community</a></li>
                                <li><a href="http://onboarding.ropensci.org/">Contribute software</a></li>
                                <li><a href="http://unconf17.ropensci.org/">Unconference</a></li>
                                <li><a href="/coc">Code of conduct</a></li>
                                <li><a href="/donate/">Donate</a></li>
                            </ul>
                        </div>
                        <div class="col-4 top-8 bottom-8">
                            <h5 class="bottom-2"></h5>

                            <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                            <a href="http://numfocus.org" target="_blank"><img src="img/numfocus.png"></a>
                            <br>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 top-8 bottom-9 divider">
                    <p class="top-9">Except where otherwise noted, content on this site is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY license</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>




    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    

    
    <script type="text/javascript" src="/js/highlight.pack.js"></script>
    <script type="text/javascript">
        hljs.initHighlightingOnLoad();
    </script>



</body>
</html>
