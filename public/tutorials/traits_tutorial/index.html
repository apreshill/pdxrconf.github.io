<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>rOpenSci | traits tutorial</title>

     
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>

    <script type="text/javascript">
    hljs.configure({languages: []});
    hljs.initHighlightingOnLoad();
    </script>
    <link rel="stylesheet" type="text/css" href="/css/style-new.css" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#4b8add">
<meta name="theme-color" content="#4b8add">


    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

    
    <div id="header">
        <div class="container">
            <div class="row center-m">
                
                <div class="col-1">
                    <a href="/index.html"><img src="/img/icon_lettering_white.svg" /></a>
                </div>
                
                
                <nav class="col-6 col-offset-4 top-3">
                    <ul class="row between">
						<li><a href="/about/">About</a></li>
                        <li><a href="/blog/">Blog</a></li>
                        <li><a href="/packages/">Packages</a></li>
                        <li><a href="/community/">Community</a></li>
                        <li><a href="http://discuss.ropensci.org/" target="_blank">Discuss</a></li>

                    </ul>
                </nav>
                
            </div>
        </div>
    </div>



    <article>
        <div class="container top-20">
            
            <div class="row centered">
                
                <div class="col-7 bottom-20 maintext">
                    <h1>traits tutorial</h1>
                    <br>
                    <h4><small style="color:grey">for v0.3.0</small></h4>
                    <br>

                    <article>
                    

<h3 id="installation">Installation</h3>

<p>Install and load <code>traits</code> into the R session. Stable version from CRAN</p>

<pre><code class="language-r">install.packages(&quot;traits&quot;)
</code></pre>

<p>Or development version from Github:</p>

<pre><code class="language-r">if (!require(&quot;devtools&quot;)) install.packages(&quot;devtools&quot;)
devtools::install_github(&quot;ropensci/traits&quot;)
</code></pre>

<pre><code class="language-r">library(&quot;traits&quot;)
</code></pre>

<h2 id="usage">Usage</h2>

<h3 id="betydb">BetyDB</h3>

<p>Get trait data for Willow (<em>Salix</em> spp.)</p>

<pre><code class="language-r">(salix &lt;- betydb_search(&quot;Salix Vcmax&quot;))
</code></pre>

<pre><code>#&gt; # A tibble: 14 x 36
#&gt;    access_level       author checked citation_id citation_year  city
#&gt;  *        &lt;int&gt;        &lt;chr&gt;   &lt;int&gt;       &lt;int&gt;         &lt;int&gt; &lt;chr&gt;
#&gt;  1            4 Wullschleger       1          51          1993  &lt;NA&gt;
#&gt;  2            4         Wang       1         381          2010  &lt;NA&gt;
#&gt;  3            4       Merilo       1         430          2005 Saare
#&gt;  4            4       Merilo       1         430          2005 Saare
#&gt;  5            4       Merilo       1         430          2005 Saare
#&gt;  6            4       Merilo       1         430          2005 Saare
#&gt;  7            4       Merilo       1         430          2005 Saare
#&gt;  8            4       Merilo       1         430          2005 Saare
#&gt;  9            4       Merilo       1         430          2005 Saare
#&gt; 10            4       Merilo       1         430          2005 Saare
#&gt; 11            4       Merilo       1         430          2005 Saare
#&gt; 12            4       Merilo       1         430          2005 Saare
#&gt; 13            4       Merilo       1         430          2005 Saare
#&gt; 14            4       Merilo       1         430          2005 Saare
#&gt; # ... with 30 more variables: commonname &lt;chr&gt;, cultivar &lt;chr&gt;,
#&gt; #   cultivar_id &lt;int&gt;, date &lt;chr&gt;, dateloc &lt;chr&gt;, entity &lt;lgl&gt;,
#&gt; #   genus &lt;chr&gt;, id &lt;int&gt;, lat &lt;dbl&gt;, lon &lt;dbl&gt;, mean &lt;dbl&gt;,
#&gt; #   method_name &lt;lgl&gt;, month &lt;int&gt;, n &lt;int&gt;, notes &lt;chr&gt;, raw_date &lt;chr&gt;,
#&gt; #   result_type &lt;chr&gt;, scientificname &lt;chr&gt;, site_id &lt;int&gt;,
#&gt; #   sitename &lt;chr&gt;, species_id &lt;int&gt;, stat &lt;dbl&gt;, statname &lt;chr&gt;,
#&gt; #   time &lt;chr&gt;, trait &lt;chr&gt;, trait_description &lt;chr&gt;, treatment &lt;chr&gt;,
#&gt; #   treatment_id &lt;int&gt;, units &lt;chr&gt;, year &lt;int&gt;
</code></pre>

<pre><code class="language-r"># equivalent:
# (out &lt;- betydb_search(&quot;willow&quot;))
</code></pre>

<p>Summarise data from the output <code>data.frame</code></p>

<pre><code class="language-r">library(&quot;dplyr&quot;)
salix %&gt;%
  group_by(scientificname, trait) %&gt;%
  mutate(.mean = as.numeric(mean)) %&gt;%
  summarise(mean = round(mean(.mean, na.rm = TRUE), 2),
            min = round(min(.mean, na.rm = TRUE), 2),
            max = round(max(.mean, na.rm = TRUE), 2),
            n = length(n))
</code></pre>

<pre><code>#&gt;    mean   min   max  n
#&gt; 1 48.06 19.99 79.28 14
</code></pre>

<h3 id="ncbi-sequence-data">NCBI sequence data</h3>

<p>Get sequences by id</p>

<pre><code class="language-r">ncbi_byid(ids = &quot;360040093&quot;)
</code></pre>

<pre><code>#&gt;                  taxon
#&gt; 1 Eristalis transversa
#&gt;                                                                                                             gene_desc
#&gt; 1 Eristalis transversa voucher CNC:Diptera:102013 cytochrome oxidase subunit 1 (COI) gene, partial cds; mitochondrial
#&gt;       gi_no     acc_no length
#&gt; 1 360040093 JN991986.1    658
#&gt;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             sequence
#&gt; 1 tactttatattttgtatttggaacatgagcgggtatagtaggaacttcattaagaattttaattcgagctgaattaggtcatccaggtgcattaattggtgatgatcaaatttataatgttattgtaacagctcatgcttttgttataattttttttatagtaatacctattataattggaggatttggaaattgattagtaccacttatattaggagctccagatatagcattccctcgaataaataatataagtttctgattattacctccttctttaactctattattagtaagaagtatagtagaaaatggggctggaacaggatgaacagtttatcctccattatcaagtaatattgcacatggaggagcctcagttgatttagcaattttttcacttcacttatcaggaatatcatctattttaggtgcagtaaattttattacaacagttattaatatacgatcaacaggaattacttatgatcgtatacctttatttgtttgatctgttgctattacagctttattattattattatcattaccagtactagcaggagctattacaatattattaactgatcgaaatttaaatacatcattctttgatccagcaggaggaggagaccctatcctgtaccaacacttattc
</code></pre>

<p>Get sequences searching by taxonomic name</p>

<pre><code class="language-r">out &lt;- ncbi_searcher(taxa = &quot;Umbra limi&quot;, seqrange = &quot;1:2000&quot;)
head(out)
</code></pre>

<pre><code>#&gt;        taxon length
#&gt; 1 Umbra limi    761
#&gt; 2 Umbra limi    765
#&gt; 3 Umbra limi    764
#&gt; 4 Umbra limi    743
#&gt; 5 Umbra limi    758
#&gt;                                                                                          gene_desc
#&gt; 1                                  Umbra limi voucher NXG2012264 rhodopsin (Rho) gene, partial cds
#&gt; 2                                   Umbra limi voucher NXG201250 rhodopsin (Rho) gene, partial cds
#&gt; 3                                  Umbra limi voucher NXG2012183 rhodopsin (Rho) gene, partial cds
#&gt; 4                                   Umbra limi voucher NXG201252 rhodopsin (Rho) gene, partial cds
#&gt; 5                                  Umbra limi voucher NXG2012231 rhodopsin (Rho) gene, partial cds
#&gt;     acc_no      gi_no
#&gt; 1 KX146134 1049488959
#&gt; 2 KX146015 1049488721
#&gt; 3 KX145969 1049488629
#&gt; 4 KX145777 1049488245
#&gt; 5 KX145759 1049488209
#&gt;  [ reached getOption(&quot;max.print&quot;) -- omitted 1 row ]
</code></pre>

<h3 id="eol-s-traitbank-data">EOL&rsquo;s Traitbank data</h3>

<p>Note that EOL&rsquo;s Traitbank does not allow us to search by trait.
The only interface we have is to search by taxon page ID.</p>

<p>Searching for <em>Potus flavus</em>, page id <code>328574</code></p>

<pre><code class="language-r">res &lt;- traitbank(pageid = 328574)
res$graph %&gt;%
  select(dwc.measurementtype,
         dwc.measurementvalue) %&gt;%
  filter(!is.na(dwc.measurementvalue))
</code></pre>

<h3 id="coral">Coral</h3>

<p>Get the species list and their ids</p>

<pre><code class="language-r">coral_species()
</code></pre>

<pre><code>#&gt; # A tibble: 1,548 x 2
#&gt;                          name    id
#&gt;                         &lt;chr&gt; &lt;chr&gt;
#&gt;  1        Acanthastrea brevis     3
#&gt;  2      Acanthastrea echinata     4
#&gt;  3     Acanthastrea hemprichi     6
#&gt;  4 Acanthastrea ishigakiensis     8
#&gt;  5     Acanthastrea regularis    12
#&gt;  6  Acanthastrea rotundoflora    13
#&gt;  7   Acanthastrea subechinata    14
#&gt;  8     Acropora abrolhosensis    16
#&gt;  9      Acropora abrotanoides    17
#&gt; 10           Acropora aculeus    18
#&gt; # ... with 1,538 more rows
</code></pre>

<p>Get data by taxon</p>

<pre><code class="language-r">coral_taxa(80)
</code></pre>

<pre><code>#&gt; # A tibble: 3,540 x 25
#&gt;    observation_id access user_id specie_id         specie_name location_id
#&gt;             &lt;int&gt;  &lt;int&gt;   &lt;int&gt;     &lt;int&gt;               &lt;chr&gt;       &lt;int&gt;
#&gt;  1         157133      1      10        80 Acropora hyacinthus           1
#&gt;  2         156961      1      14        80 Acropora hyacinthus         409
#&gt;  3           5781      1       1        80 Acropora hyacinthus           1
#&gt;  4         156610      1       2        80 Acropora hyacinthus         500
#&gt;  5         158118      1      10        80 Acropora hyacinthus         409
#&gt;  6         119211      1      49        80 Acropora hyacinthus           1
#&gt;  7         158211      1      10        80 Acropora hyacinthus         413
#&gt;  8          90294      1      15        80 Acropora hyacinthus         341
#&gt;  9          90294      1      15        80 Acropora hyacinthus         341
#&gt; 10          90294      1      15        80 Acropora hyacinthus         341
#&gt; # ... with 3,530 more rows, and 19 more variables: location_name &lt;chr&gt;,
#&gt; #   latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, resource_id &lt;int&gt;,
#&gt; #   resource_secondary_id &lt;int&gt;, measurement_id &lt;int&gt;, trait_id &lt;int&gt;,
#&gt; #   trait_name &lt;chr&gt;, standard_id &lt;int&gt;, standard_unit &lt;chr&gt;,
#&gt; #   methodology_id &lt;int&gt;, methodology_name &lt;chr&gt;, value &lt;chr&gt;,
#&gt; #   value_type &lt;chr&gt;, precision &lt;dbl&gt;, precision_type &lt;chr&gt;,
#&gt; #   precision_upper &lt;dbl&gt;, replicates &lt;int&gt;, notes &lt;chr&gt;
</code></pre>

<p>Get data by trait</p>

<pre><code class="language-r">coral_traits(105)
</code></pre>

<pre><code>#&gt; # A tibble: 0 x 25
#&gt; # ... with 25 variables: observation_id &lt;lgl&gt;, access &lt;lgl&gt;,
#&gt; #   user_id &lt;lgl&gt;, specie_id &lt;lgl&gt;, specie_name &lt;lgl&gt;, location_id &lt;lgl&gt;,
#&gt; #   location_name &lt;lgl&gt;, latitude &lt;lgl&gt;, longitude &lt;lgl&gt;,
#&gt; #   resource_id &lt;lgl&gt;, resource_secondary_id &lt;lgl&gt;, measurement_id &lt;lgl&gt;,
#&gt; #   trait_id &lt;lgl&gt;, trait_name &lt;lgl&gt;, standard_id &lt;lgl&gt;,
#&gt; #   standard_unit &lt;lgl&gt;, methodology_id &lt;lgl&gt;, methodology_name &lt;lgl&gt;,
#&gt; #   value &lt;lgl&gt;, value_type &lt;lgl&gt;, precision &lt;lgl&gt;, precision_type &lt;lgl&gt;,
#&gt; #   precision_upper &lt;lgl&gt;, replicates &lt;lgl&gt;, notes &lt;lgl&gt;
</code></pre>

<h3 id="birdlife-international">Birdlife International</h3>

<p>Habitat data</p>

<pre><code class="language-r">birdlife_habitat(22721692)
</code></pre>

<pre><code>#&gt;         id Habitat (level 1)                  Habitat (level 2) Importance
#&gt; 1 22721692            Forest           Subtropical/Tropical Dry   suitable
#&gt; 2 22721692            Forest Subtropical/Tropical Moist Montane      major
#&gt; 3 22721692            Forest                          Temperate   suitable
#&gt; 4 22721692         Shrubland Subtropical/Tropical High Altitude   suitable
#&gt;     Occurrence
#&gt; 1     breeding
#&gt; 2 non-breeding
#&gt; 3     breeding
#&gt; 4     breeding
</code></pre>

<p>Threats data</p>

<pre><code class="language-r">birdlife_threats(22721692)
</code></pre>

<pre><code>#&gt;         id                                                  threat1
#&gt; 1 22721692                                Agriculture &amp; aquaculture
#&gt; 2 22721692                                Agriculture &amp; aquaculture
#&gt; 3 22721692                                  Biological resource use
#&gt;                               threat2
#&gt; 1 Annual &amp; perennial non-timber crops
#&gt; 2 Annual &amp; perennial non-timber crops
#&gt; 3           Logging &amp; wood harvesting
#&gt;                                      stresses
#&gt; 1 Ecosystem degradation, Ecosystem conversion
#&gt; 2 Ecosystem degradation, Ecosystem conversion
#&gt; 3                       Ecosystem degradation
#&gt;                                                     timing
#&gt; 1                                Agriculture &amp; aquaculture
#&gt; 2                                Agriculture &amp; aquaculture
#&gt; 3                                  Biological resource use
#&gt;                                 scope severity  impact
#&gt; 1 Annual &amp; perennial non-timber crops  Ongoing Ongoing
#&gt; 2 Annual &amp; perennial non-timber crops  Ongoing Ongoing
#&gt; 3           Logging &amp; wood harvesting  Ongoing Ongoing
#&gt;  [ reached getOption(&quot;max.print&quot;) -- omitted 3 rows ]
</code></pre>

<h3 id="citing">Citing</h3>

<p>To cite <code>traits</code> in publications use:</p>

<p><br></p>

<blockquote>
<p>Scott Chamberlain, Zachary Foster, Ignasi Bartomeus, David LeBauer
  and David Harris (2017). traits: Species Trait Data from Around the
  Web. R package version 0.3.0.
  <a href="https://CRAN.R-project.org/package=traits">https://CRAN.R-project.org/package=traits</a></p>
</blockquote>

<h3 id="license-and-bugs">License and bugs</h3>

<ul>
<li>License: <a href="http://opensource.org/licenses/MIT">MIT</a></li>
<li>Report bugs at <a href="https://github.com/ropensci/traits/issues?state=open">our Github repo for traits</a></li>
</ul>

<p><a href="#top">Back to top</a></p>

                    </article>
                </div>

                </div>
            </div>
        </div>
    </article>


    <div id="footer">
        <div class="container">
            <div class="row start">
                <div class="col-1 col-1-3 top-8">
                    <img src="/img/icon_short_white.svg" />
                </div>

                <div class="col-9 col-offset-2 top-10 bottom-8">
                    <div class="row between">
                        <div class="col-2 col-1-3">
                            <a href="http://github.com/ropensci" target="_blank"><div class="icon icon-github"></div></a>
                            <a href="http://twitter.com/ropensci" target="_blank"><div class="icon icon-twitter"></div></a>
                            <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon icon-vimeo"></div></a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Info</h5>
                                <li><a href="/about">Mission</a></li>
                                <li><a href="/about#team">Team</a></li>
                                <li><a href="/about#collaborators">Collaborators</a></li>
                                <li><a href="/careers">Careers</a></li>

                            </ul>
                        </div>

                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Work</h5>
                                <li><a href="/packages/">Packages</a></li>
                                <li><a href="/blog/">Blog</a></li>
                                <li><a href="/technotes/">Tech Notes</a></li>
                                <li><a href="/tutorials/">Tutorials</a></li>
                                <li><a href="/usecases/">Use Cases</a></li>
                                <li><a href="/resources/">More Resources</a></li>
                            </ul>
                        </div>
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Participate</h5>
                                <li><a href="/contact.html">Contact us</a></li>
                                <li><a href="/community/">Community</a></li>
                                <li><a href="http://onboarding.ropensci.org/">Contribute software</a></li>
                                <li><a href="http://unconf17.ropensci.org/">Unconference</a></li>
                                <li><a href="/coc">Code of conduct</a></li>
                                <li><a href="/donate/">Donate</a></li>
                            </ul>
                        </div>
                        <div class="col-4 top-8 bottom-8">
                            <h5 class="bottom-2"></h5>

                            <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                            <a href="http://numfocus.org" target="_blank"><img src="img/numfocus.png"></a>
                            <br>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 top-8 bottom-9 divider">
                    <p class="top-9">Except where otherwise noted, content on this site is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY license</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>




    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    

    
    <script type="text/javascript" src="/js/highlight.pack.js"></script>
    <script type="text/javascript">
        hljs.initHighlightingOnLoad();
    </script>



</body>
</html>
