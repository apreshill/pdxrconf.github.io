<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>rOpenSci | rgbif tutorial</title>

     
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>

    <script type="text/javascript">
    hljs.configure({languages: []});
    hljs.initHighlightingOnLoad();
    </script>
    <link rel="stylesheet" type="text/css" href="/css/style-new.css" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#4b8add">
<meta name="theme-color" content="#4b8add">


    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

    
    <div id="header">
        <div class="container">
            <div class="row center-m">
                
                <div class="col-1">
                    <a href="/index.html"><img src="/img/icon_lettering_white.svg" /></a>
                </div>
                
                
                <nav class="col-6 col-offset-4 top-3">
                    <ul class="row between">
						<li><a href="/about/">About</a></li>
                        <li><a href="/blog/">Blog</a></li>
                        <li><a href="/packages/">Packages</a></li>
                        <li><a href="/community/">Community</a></li>
                        <li><a href="http://discuss.ropensci.org/" target="_blank">Discuss</a></li>

                    </ul>
                </nav>
                
            </div>
        </div>
    </div>



    <article>
        <div class="container top-20">
            
            <div class="row centered">
                
                <div class="col-7 bottom-20 maintext">
                    <h1>rgbif tutorial</h1>
                    <br>
                    <h4><small style="color:grey">for v0.9.9</small></h4>
                    <br>

                    <article>
                    

<p>Seach and retrieve data from the Global Biodiverity Information Facilty (GBIF)</p>

<p><code>rgbif</code> is an R package to search and retrieve data from the Global Biodiverity Information Facilty (GBIF). <code>rgbif</code> wraps R code around the <a href="http://www.gbif.org/developer/summary">GBIF API</a> to allow you to talk to GBIF from R.</p>

<h3 id="installation">Installation</h3>

<p>Install from CRAN</p>

<pre><code class="language-r">install.packages(&quot;rgbif&quot;)
</code></pre>

<p>Or install the development version from GitHub</p>

<pre><code class="language-r">devtools::install_github(&quot;ropensci/rgbif&quot;)
</code></pre>

<p>Load rgbif</p>

<pre><code class="language-r">library(&quot;rgbif&quot;)
</code></pre>

<h3 id="number-of-occurrences">Number of occurrences</h3>

<p>Search by type of record, all observational in this case</p>

<pre><code class="language-r">occ_count(basisOfRecord='OBSERVATION')
#&gt; [1] 30364566
</code></pre>

<p>Records for <strong>Puma concolor</strong> with lat/long data (georeferened) only. Note that <code>hasCoordinate</code> in <code>occ_search()</code> is the same as <code>georeferenced</code> in <code>occ_count()</code>.</p>

<pre><code class="language-r">occ_count(taxonKey=2435099, georeferenced=TRUE)
#&gt; [1] 3747
</code></pre>

<p>All georeferenced records in GBIF</p>

<pre><code class="language-r">occ_count(georeferenced=TRUE)
#&gt; [1] 772524989
</code></pre>

<p>Records from Denmark</p>

<pre><code class="language-r">denmark_code &lt;- isocodes[grep(&quot;Denmark&quot;, isocodes$name), &quot;code&quot;]
occ_count(country=denmark_code)
#&gt; [1] 11372130
</code></pre>

<p>Number of records in a particular dataset</p>

<pre><code class="language-r">occ_count(datasetKey='9e7ea106-0bf8-4087-bb61-dfe4f29e0f17')
#&gt; [1] 4591
</code></pre>

<p>All records from 2012</p>

<pre><code class="language-r">occ_count(year=2012)
#&gt; [1] 44688340
</code></pre>

<p>Records for a particular dataset, and only for preserved specimens</p>

<pre><code class="language-r">occ_count(datasetKey='e707e6da-e143-445d-b41d-529c4a777e8b', basisOfRecord='OBSERVATION')
#&gt; [1] 0
</code></pre>

<h3 id="search-for-taxon-names">Search for taxon names</h3>

<p>Get possible values to be used in taxonomic rank arguments in functions</p>

<pre><code class="language-r">taxrank()
#&gt; [1] &quot;kingdom&quot;       &quot;phylum&quot;        &quot;class&quot;         &quot;order&quot;
#&gt; [5] &quot;family&quot;        &quot;genus&quot;         &quot;species&quot;       &quot;infraspecific&quot;
</code></pre>

<p><code>name_lookup()</code> does full text search of name usages covering the scientific and vernacular name, the species description, distribution and the entire classification across all name usages of all or some checklists. Results are ordered by relevance as this search usually returns a lot of results.</p>

<p>By default <code>name_lookup()</code> returns five slots of information: meta, data, facets, hierarchies, and names. hierarchies and names elements are named by their matching GBIF key in the <code>data.frame</code> in the data slot.</p>

<pre><code class="language-r">out &lt;- name_lookup(query='mammalia')
</code></pre>

<pre><code class="language-r">names(out)
#&gt; [1] &quot;meta&quot;        &quot;data&quot;        &quot;facets&quot;      &quot;hierarchies&quot; &quot;names&quot;
</code></pre>

<pre><code class="language-r">out$meta
#&gt; # A tibble: 1 x 4
#&gt;   offset limit endOfRecords count
#&gt;    &lt;int&gt; &lt;int&gt;        &lt;lgl&gt; &lt;int&gt;
#&gt; 1      0   100        FALSE  1329
</code></pre>

<pre><code class="language-r">head(out$data)
#&gt; # A tibble: 6 x 28
#&gt;         key scientificName                           datasetKey nubKey
#&gt;       &lt;int&gt;          &lt;chr&gt;                                &lt;chr&gt;  &lt;int&gt;
#&gt; 1 114079693       Mammalia bd0a2b6d-69d1-4650-8bb1-829c8f92035f    359
#&gt; 2 123227024       Mammalia 90d9e8a6-0ce1-472d-b682-3451095dbc5a    359
#&gt; 3 115498126       Mammalia fe51a93b-a7f8-48ec-99c8-7c347716e8d3    359
#&gt; 4 127776750       Mammalia 5b3a293b-04e5-4ad7-992f-cb016fcf166a    359
#&gt; 5 100375341       Mammalia 16c3f9cb-4b19-4553-ac8e-ebb90003aa02    359
#&gt; 6 133364782       Mammalia 7ddf754f-d193-4cc9-b351-99906754a03b    359
#&gt; # ... with 24 more variables: parentKey &lt;int&gt;, parent &lt;chr&gt;,
#&gt; #   canonicalName &lt;chr&gt;, nameType &lt;chr&gt;, taxonomicStatus &lt;chr&gt;,
#&gt; #   origin &lt;chr&gt;, numDescendants &lt;int&gt;, numOccurrences &lt;int&gt;,
#&gt; #   taxonID &lt;chr&gt;, habitats &lt;chr&gt;, nomenclaturalStatus &lt;lgl&gt;,
#&gt; #   threatStatuses &lt;lgl&gt;, synonym &lt;lgl&gt;, authorship &lt;chr&gt;, kingdom &lt;chr&gt;,
#&gt; #   phylum &lt;chr&gt;, kingdomKey &lt;int&gt;, phylumKey &lt;int&gt;, classKey &lt;int&gt;,
#&gt; #   rank &lt;chr&gt;, class &lt;chr&gt;, extinct &lt;lgl&gt;, constituentKey &lt;chr&gt;,
#&gt; #   publishedIn &lt;chr&gt;
</code></pre>

<pre><code class="language-r">out$facets
#&gt; NULL
</code></pre>

<pre><code class="language-r">out$hierarchies[1:2]
#&gt; $`114079693`
#&gt;     rankkey     name
#&gt; 1 114079410 Animalia
#&gt;
#&gt; $`123227024`
#&gt;     rankkey          name
#&gt; 1 123221530 Gnathostomata
</code></pre>

<pre><code class="language-r">out$names[2]
#&gt; $`359`
#&gt;    vernacularName language
#&gt; 1      zoogdieren      nld
#&gt; 2         Mammals      eng
#&gt; 3          mammal      eng
#&gt; 4         mammals
#&gt; 5        däggdjur      swe
#&gt; 6         mammals      eng
#&gt; 7      mammifères      fra
#&gt; 8        pattedyr      nno
#&gt; 9        pattedyr      nob
#&gt; 10         sogdyr      nno
#&gt; 11        spendyr      nno
#&gt; 12     zoogdieren      nld
#&gt; 13         Ссавці      ukr
#&gt; 14           哺乳      jpn
#&gt; 15        mammals      eng
#&gt; 16    mammifÃ¨res      fra
#&gt; 17      mamÃ­fero      por
</code></pre>

<p>Search for a genus</p>

<pre><code class="language-r">head(name_lookup(query='Cnaemidophorus', rank=&quot;genus&quot;, return=&quot;data&quot;))
#&gt; # A tibble: 6 x 34
#&gt;         key scientificName                           datasetKey  nubKey
#&gt;       &lt;int&gt;          &lt;chr&gt;                                &lt;chr&gt;   &lt;int&gt;
#&gt; 1 133063907 Cnaemidophorus 4cec8fef-f129-4966-89b7-4f8439aba058 1858636
#&gt; 2 134031474 Cnaemidophorus 23905003-5ee5-4326-b1bb-3a2fd6250df3 1858636
#&gt; 3 133419671 Cnaemidophorus 7ddf754f-d193-4cc9-b351-99906754a03b 1858636
#&gt; 4 135314362 Cnaemidophorus 16c3f9cb-4b19-4553-ac8e-ebb90003aa02 1858636
#&gt; 5 135332978 Cnaemidophorus cbb6498e-8927-405a-916b-576d00a6289b 1858636
#&gt; 6 135447727 Cnaemidophorus d16563e0-e718-45a9-a20f-3e9fc20613da 1858636
#&gt; # ... with 30 more variables: parentKey &lt;int&gt;, parent &lt;chr&gt;, phylum &lt;chr&gt;,
#&gt; #   order &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;, phylumKey &lt;int&gt;,
#&gt; #   classKey &lt;int&gt;, orderKey &lt;int&gt;, familyKey &lt;int&gt;, genusKey &lt;int&gt;,
#&gt; #   canonicalName &lt;chr&gt;, taxonomicStatus &lt;chr&gt;, rank &lt;chr&gt;, origin &lt;chr&gt;,
#&gt; #   numDescendants &lt;int&gt;, numOccurrences &lt;int&gt;, habitats &lt;lgl&gt;,
#&gt; #   nomenclaturalStatus &lt;lgl&gt;, threatStatuses &lt;lgl&gt;, synonym &lt;lgl&gt;,
#&gt; #   class &lt;chr&gt;, kingdom &lt;chr&gt;, kingdomKey &lt;int&gt;, nameType &lt;chr&gt;,
#&gt; #   taxonID &lt;chr&gt;, authorship &lt;chr&gt;, publishedIn &lt;chr&gt;, extinct &lt;lgl&gt;,
#&gt; #   constituentKey &lt;chr&gt;
</code></pre>

<p>Search for the class mammalia</p>

<pre><code class="language-r">head(name_lookup(query='mammalia', return = 'data'))
#&gt; # A tibble: 6 x 28
#&gt;         key scientificName                           datasetKey nubKey
#&gt;       &lt;int&gt;          &lt;chr&gt;                                &lt;chr&gt;  &lt;int&gt;
#&gt; 1 114079693       Mammalia bd0a2b6d-69d1-4650-8bb1-829c8f92035f    359
#&gt; 2 123227024       Mammalia 90d9e8a6-0ce1-472d-b682-3451095dbc5a    359
#&gt; 3 115498126       Mammalia fe51a93b-a7f8-48ec-99c8-7c347716e8d3    359
#&gt; 4 127776750       Mammalia 5b3a293b-04e5-4ad7-992f-cb016fcf166a    359
#&gt; 5 100375341       Mammalia 16c3f9cb-4b19-4553-ac8e-ebb90003aa02    359
#&gt; 6 133364782       Mammalia 7ddf754f-d193-4cc9-b351-99906754a03b    359
#&gt; # ... with 24 more variables: parentKey &lt;int&gt;, parent &lt;chr&gt;,
#&gt; #   canonicalName &lt;chr&gt;, nameType &lt;chr&gt;, taxonomicStatus &lt;chr&gt;,
#&gt; #   origin &lt;chr&gt;, numDescendants &lt;int&gt;, numOccurrences &lt;int&gt;,
#&gt; #   taxonID &lt;chr&gt;, habitats &lt;chr&gt;, nomenclaturalStatus &lt;lgl&gt;,
#&gt; #   threatStatuses &lt;lgl&gt;, synonym &lt;lgl&gt;, authorship &lt;chr&gt;, kingdom &lt;chr&gt;,
#&gt; #   phylum &lt;chr&gt;, kingdomKey &lt;int&gt;, phylumKey &lt;int&gt;, classKey &lt;int&gt;,
#&gt; #   rank &lt;chr&gt;, class &lt;chr&gt;, extinct &lt;lgl&gt;, constituentKey &lt;chr&gt;,
#&gt; #   publishedIn &lt;chr&gt;
</code></pre>

<p>Look up the species Helianthus annuus</p>

<pre><code class="language-r">head(name_lookup(query = 'Helianthus annuus', rank=&quot;species&quot;, return = 'data'))
#&gt; # A tibble: 6 x 42
#&gt;         key    scientificName                           datasetKey
#&gt;       &lt;int&gt;             &lt;chr&gt;                                &lt;chr&gt;
#&gt; 1   3119195 Helianthus annuus d7dddbf4-2cf0-4f39-9b2a-bb099caae36c
#&gt; 2 134854463 Helianthus annuus f82a4f7f-6f84-4b58-82e6-6b41ec9a1f49
#&gt; 3 114910965 Helianthus annuus ee2aac07-de9a-47a2-b828-37430d537633
#&gt; 4 134843454 Helianthus annuus 29d2d5a6-db22-4abd-b784-9ab2f9757c3c
#&gt; 5 127670355 Helianthus annuus 41c06f1a-23da-4445-b859-ec3a8a03b0e2
#&gt; 6 103340289 Helianthus annuus fab88965-e69d-4491-a04d-e3198b626e52
#&gt; # ... with 39 more variables: constituentKey &lt;chr&gt;, nubKey &lt;int&gt;,
#&gt; #   parentKey &lt;int&gt;, parent &lt;chr&gt;, kingdom &lt;chr&gt;, phylum &lt;chr&gt;,
#&gt; #   order &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;, species &lt;chr&gt;,
#&gt; #   kingdomKey &lt;int&gt;, phylumKey &lt;int&gt;, classKey &lt;int&gt;, orderKey &lt;int&gt;,
#&gt; #   familyKey &lt;int&gt;, genusKey &lt;int&gt;, speciesKey &lt;int&gt;,
#&gt; #   canonicalName &lt;chr&gt;, authorship &lt;chr&gt;, publishedIn &lt;chr&gt;,
#&gt; #   nameType &lt;chr&gt;, taxonomicStatus &lt;chr&gt;, rank &lt;chr&gt;, origin &lt;chr&gt;,
#&gt; #   numDescendants &lt;int&gt;, numOccurrences &lt;int&gt;, extinct &lt;lgl&gt;,
#&gt; #   habitats &lt;chr&gt;, nomenclaturalStatus &lt;chr&gt;, threatStatuses &lt;lgl&gt;,
#&gt; #   synonym &lt;lgl&gt;, class &lt;chr&gt;, taxonID &lt;chr&gt;, acceptedKey &lt;int&gt;,
#&gt; #   accepted &lt;chr&gt;, accordingTo &lt;chr&gt;, nameKey &lt;int&gt;, basionymKey &lt;int&gt;,
#&gt; #   basionym &lt;chr&gt;
</code></pre>

<p>The function <code>name_usage()</code> works with lots of different name endpoints in GBIF, listed at <a href="http://www.gbif.org/developer/species#nameUsages">http://www.gbif.org/developer/species#nameUsages</a>.</p>

<pre><code class="language-r">library(&quot;plyr&quot;)
out &lt;- name_usage(key=3119195, language=&quot;FRENCH&quot;, data='vernacularNames')
head(out$data)
#&gt; # A tibble: 6 x 6
#&gt;   taxonKey   vernacularName language
#&gt;      &lt;int&gt;            &lt;chr&gt;    &lt;chr&gt;
#&gt; 1  3119195 common sunflower      eng
#&gt; 2  3119195        tournesol      fra
#&gt; 3  3119195 garden sunflower      eng
#&gt; 4  3119195     grand soleil      fra
#&gt; 5  3119195 hélianthe annuel      fra
#&gt; 6  3119195           soleil      fra
#&gt; # ... with 3 more variables: source &lt;chr&gt;, sourceTaxonKey &lt;int&gt;,
#&gt; #   preferred &lt;lgl&gt;
</code></pre>

<p>The function <code>name_backbone()</code> is used to search against the GBIF backbone taxonomy</p>

<pre><code class="language-r">name_backbone(name='Helianthus', rank='genus', kingdom='plants')
#&gt; $usageKey
#&gt; [1] 3119134
#&gt;
#&gt; $scientificName
#&gt; [1] &quot;Helianthus L.&quot;
#&gt;
#&gt; $canonicalName
#&gt; [1] &quot;Helianthus&quot;
#&gt;
#&gt; $rank
#&gt; [1] &quot;GENUS&quot;
#&gt;
#&gt; $status
#&gt; [1] &quot;ACCEPTED&quot;
#&gt;
#&gt; $confidence
#&gt; [1] 97
#&gt;
#&gt; $matchType
#&gt; [1] &quot;EXACT&quot;
#&gt;
#&gt; $kingdom
#&gt; [1] &quot;Plantae&quot;
#&gt;
#&gt; $phylum
#&gt; [1] &quot;Tracheophyta&quot;
#&gt;
#&gt; $order
#&gt; [1] &quot;Asterales&quot;
#&gt;
#&gt; $family
#&gt; [1] &quot;Asteraceae&quot;
#&gt;
#&gt; $genus
#&gt; [1] &quot;Helianthus&quot;
#&gt;
#&gt; $kingdomKey
#&gt; [1] 6
#&gt;
#&gt; $phylumKey
#&gt; [1] 7707728
#&gt;
#&gt; $classKey
#&gt; [1] 220
#&gt;
#&gt; $orderKey
#&gt; [1] 414
#&gt;
#&gt; $familyKey
#&gt; [1] 3065
#&gt;
#&gt; $genusKey
#&gt; [1] 3119134
#&gt;
#&gt; $synonym
#&gt; [1] FALSE
#&gt;
#&gt; $class
#&gt; [1] &quot;Magnoliopsida&quot;
</code></pre>

<p>The function <code>name_suggest()</code> is optimized for speed, and gives back suggested names based on query parameters.</p>

<pre><code class="language-r">head( name_suggest(q='Puma concolor') )
#&gt; # A tibble: 6 x 3
#&gt;       key                canonicalName       rank
#&gt;     &lt;int&gt;                        &lt;chr&gt;      &lt;chr&gt;
#&gt; 1 2435099                Puma concolor    SPECIES
#&gt; 2 8951716      Puma concolor borbensis SUBSPECIES
#&gt; 3 6164618         Puma concolor browni SUBSPECIES
#&gt; 4 8860878 Puma concolor capricornensis SUBSPECIES
#&gt; 5 8916934         Puma concolor bangsi SUBSPECIES
#&gt; 6 6164599         Puma concolor azteca SUBSPECIES
</code></pre>

<h3 id="single-occurrence-records">Single occurrence records</h3>

<p>Get data for a single occurrence. Note that data is returned as a list, with slots for metadata and data, or as a hierarchy, or just data.</p>

<p>Just data</p>

<pre><code class="language-r">occ_get(key=240713150, return='data')
#&gt;       name       key decimalLatitude decimalLongitude             issues
#&gt; 1 Pelosina 240713150        -77.5667          163.583 bri,cdround,gass84
</code></pre>

<p>Just taxonomic hierarchy</p>

<pre><code class="language-r">occ_get(key=240713150, return='hier')
#&gt;            name     key    rank
#&gt; 1     Chromista       4 kingdom
#&gt; 2  Foraminifera 8376456  phylum
#&gt; 3  Monothalamea 7882876   class
#&gt; 4  Astrorhizida 8142878   order
#&gt; 5 Astrorhizidae 7747923  family
#&gt; 6      Pelosina 7822114   genus
</code></pre>

<p>All data, or leave return parameter blank</p>

<pre><code class="language-r">occ_get(key=240713150, return='all')
#&gt; $hierarchy
#&gt;            name     key    rank
#&gt; 1     Chromista       4 kingdom
#&gt; 2  Foraminifera 8376456  phylum
#&gt; 3  Monothalamea 7882876   class
#&gt; 4  Astrorhizida 8142878   order
#&gt; 5 Astrorhizidae 7747923  family
#&gt; 6      Pelosina 7822114   genus
#&gt;
#&gt; $media
#&gt; list()
#&gt;
#&gt; $data
#&gt;       name       key decimalLatitude decimalLongitude             issues
#&gt; 1 Pelosina 240713150        -77.5667          163.583 bri,cdround,gass84
</code></pre>

<p>Get many occurrences. <code>occ_get</code> is vectorized</p>

<pre><code class="language-r">occ_get(key=c(101010, 240713150, 855998194), return='data')
#&gt;                   name       key decimalLatitude decimalLongitude
#&gt; 1 Platydoras armatulus    101010              NA               NA
#&gt; 2             Pelosina 240713150       -77.56670        163.58299
#&gt; 3     Sciurus vulgaris 855998194        58.40677         12.04386
#&gt;                 issues
#&gt; 1
#&gt; 2   bri,cdround,gass84
#&gt; 3 cdround,gass84,rdatm
</code></pre>

<h3 id="search-for-occurrences">Search for occurrences</h3>

<p>By default <code>occ_search()</code> returns a <code>dplyr</code> like output summary in which the data printed expands based on how much data is returned, and the size of your window. You can search by scientific name:</p>

<pre><code class="language-r">occ_search(scientificName = &quot;Ursus americanus&quot;, limit = 20)
#&gt; Records found [9455]
#&gt; Records returned [20]
#&gt; No. unique hierarchies [1]
#&gt; No. media records [16]
#&gt; No. facets [0]
#&gt; Args [limit=20, offset=0, scientificName=Ursus americanus, fields=all]
#&gt; # A tibble: 20 x 66
#&gt;                name        key decimalLatitude decimalLongitude
#&gt;               &lt;chr&gt;      &lt;int&gt;           &lt;dbl&gt;            &lt;dbl&gt;
#&gt;  1 Ursus americanus 1671722060        33.47152        -91.64752
#&gt;  2 Ursus americanus 1453325042        37.36325        -80.52914
#&gt;  3 Ursus americanus 1453341157        35.44519        -83.75077
#&gt;  4 Ursus americanus 1453341156        35.43836        -83.66423
#&gt;  5 Ursus americanus 1453427952        35.61469        -82.47723
#&gt;  6 Ursus americanus 1453476835        29.24034       -103.30502
#&gt;  7 Ursus americanus 1453456359        25.31110       -100.96992
#&gt;  8 Ursus americanus 1453414927        47.90953        -91.95893
#&gt;  9 Ursus americanus 1453456338        25.30959       -100.96966
#&gt; 10 Ursus americanus 1453445710        35.59506        -82.55149
#&gt; 11 Ursus americanus 1457591001        38.93946       -119.94679
#&gt; 12 Ursus americanus 1640034659        39.20098       -123.16410
#&gt; 13 Ursus americanus 1500285318        45.51560        -69.35556
#&gt; 14 Ursus americanus 1455592330        46.34195        -83.98219
#&gt; 15 Ursus americanus 1571069736        25.25062       -100.94652
#&gt; 16 Ursus americanus 1500319247        32.89649       -109.48065
#&gt; 17 Ursus americanus 1453476285        35.94219        -76.57357
#&gt; 18 Ursus americanus 1457595069        46.59933        -84.46328
#&gt; 19 Ursus americanus 1500222058        25.34884       -100.91091
#&gt; 20 Ursus americanus 1500223333        45.38687        -76.10825
#&gt; # ... with 62 more variables: issues &lt;chr&gt;, datasetKey &lt;chr&gt;,
#&gt; #   publishingOrgKey &lt;chr&gt;, publishingCountry &lt;chr&gt;, protocol &lt;chr&gt;,
#&gt; #   lastCrawled &lt;chr&gt;, lastParsed &lt;chr&gt;, crawlId &lt;int&gt;, extensions &lt;chr&gt;,
#&gt; #   basisOfRecord &lt;chr&gt;, taxonKey &lt;int&gt;, kingdomKey &lt;int&gt;,
#&gt; #   phylumKey &lt;int&gt;, classKey &lt;int&gt;, orderKey &lt;int&gt;, familyKey &lt;int&gt;,
#&gt; #   genusKey &lt;int&gt;, speciesKey &lt;int&gt;, scientificName &lt;chr&gt;, kingdom &lt;chr&gt;,
#&gt; #   phylum &lt;chr&gt;, order &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;, species &lt;chr&gt;,
#&gt; #   genericName &lt;chr&gt;, specificEpithet &lt;chr&gt;, taxonRank &lt;chr&gt;,
#&gt; #   dateIdentified &lt;chr&gt;, coordinateUncertaintyInMeters &lt;dbl&gt;, year &lt;int&gt;,
#&gt; #   month &lt;int&gt;, day &lt;int&gt;, eventDate &lt;chr&gt;, modified &lt;chr&gt;,
#&gt; #   lastInterpreted &lt;chr&gt;, references &lt;chr&gt;, license &lt;chr&gt;,
#&gt; #   identifiers &lt;chr&gt;, facts &lt;chr&gt;, relations &lt;chr&gt;, geodeticDatum &lt;chr&gt;,
#&gt; #   class &lt;chr&gt;, countryCode &lt;chr&gt;, country &lt;chr&gt;, rightsHolder &lt;chr&gt;,
#&gt; #   identifier &lt;chr&gt;, verbatimEventDate &lt;chr&gt;, datasetName &lt;chr&gt;,
#&gt; #   verbatimLocality &lt;chr&gt;, gbifID &lt;chr&gt;, collectionCode &lt;chr&gt;,
#&gt; #   occurrenceID &lt;chr&gt;, taxonID &lt;chr&gt;, catalogNumber &lt;chr&gt;,
#&gt; #   recordedBy &lt;chr&gt;, http...unknown.org.occurrenceDetails &lt;chr&gt;,
#&gt; #   institutionCode &lt;chr&gt;, rights &lt;chr&gt;, identificationID &lt;chr&gt;,
#&gt; #   eventTime &lt;chr&gt;, occurrenceRemarks &lt;chr&gt;
</code></pre>

<p>Or to be more precise, you can search for names first, make sure you have the right name, then pass the GBIF key to the <code>occ_search()</code> function:</p>

<pre><code class="language-r">key &lt;- name_suggest(q='Helianthus annuus', rank='species')$key[1]
occ_search(taxonKey=key, limit=20)
#&gt; Records found [18310]
#&gt; Records returned [20]
#&gt; No. unique hierarchies [1]
#&gt; No. media records [1]
#&gt; No. facets [0]
#&gt; Args [limit=20, offset=0, taxonKey=9206251, fields=all]
#&gt; # A tibble: 20 x 88
#&gt;                 name        key decimalLatitude decimalLongitude
#&gt;                &lt;chr&gt;      &lt;int&gt;           &lt;dbl&gt;            &lt;dbl&gt;
#&gt;  1 Helianthus annuus 1433793045        59.66859         16.54257
#&gt;  2 Helianthus annuus 1434024463        63.71622         20.31247
#&gt;  3 Helianthus annuus 1563876655              NA               NA
#&gt;  4 Helianthus annuus 1436147509        59.85465         17.79089
#&gt;  5 Helianthus annuus 1436223234        59.85509         17.78900
#&gt;  6 Helianthus annuus 1450388036        56.60630         16.64841
#&gt;  7 Helianthus annuus 1499896133        58.76637         16.24997
#&gt;  8 Helianthus annuus 1499929475        59.85530         17.79055
#&gt;  9 Helianthus annuus 1669229145        59.85530         17.79055
#&gt; 10 Helianthus annuus 1669043510        59.74332         17.78161
#&gt; 11 Helianthus annuus 1669900943        57.73119         16.13173
#&gt; 12 Helianthus annuus 1669884935        56.64750         12.85256
#&gt; 13 Helianthus annuus 1669797382        55.72320         13.18387
#&gt; 14 Helianthus annuus 1669882522        58.53514         16.50554
#&gt; 15 Helianthus annuus 1670276641        57.30363         11.90345
#&gt; 16 Helianthus annuus 1669981909        57.72138         11.94415
#&gt; 17 Helianthus annuus 1670011022        59.85046         17.68560
#&gt; 18 Helianthus annuus 1670291603        59.15281         18.17448
#&gt; 19 Helianthus annuus 1670396073        59.70498         16.51416
#&gt; 20 Helianthus annuus 1670269738        59.70552         16.20511
#&gt; # ... with 84 more variables: issues &lt;chr&gt;, datasetKey &lt;chr&gt;,
#&gt; #   publishingOrgKey &lt;chr&gt;, publishingCountry &lt;chr&gt;, protocol &lt;chr&gt;,
#&gt; #   lastCrawled &lt;chr&gt;, lastParsed &lt;chr&gt;, crawlId &lt;int&gt;, extensions &lt;chr&gt;,
#&gt; #   basisOfRecord &lt;chr&gt;, individualCount &lt;int&gt;, taxonKey &lt;int&gt;,
#&gt; #   kingdomKey &lt;int&gt;, phylumKey &lt;int&gt;, classKey &lt;int&gt;, orderKey &lt;int&gt;,
#&gt; #   familyKey &lt;int&gt;, genusKey &lt;int&gt;, speciesKey &lt;int&gt;,
#&gt; #   scientificName &lt;chr&gt;, kingdom &lt;chr&gt;, phylum &lt;chr&gt;, order &lt;chr&gt;,
#&gt; #   family &lt;chr&gt;, genus &lt;chr&gt;, species &lt;chr&gt;, genericName &lt;chr&gt;,
#&gt; #   specificEpithet &lt;chr&gt;, taxonRank &lt;chr&gt;,
#&gt; #   coordinateUncertaintyInMeters &lt;dbl&gt;, continent &lt;chr&gt;, year &lt;int&gt;,
#&gt; #   month &lt;int&gt;, day &lt;int&gt;, eventDate &lt;chr&gt;, modified &lt;chr&gt;,
#&gt; #   lastInterpreted &lt;chr&gt;, license &lt;chr&gt;, identifiers &lt;chr&gt;, facts &lt;chr&gt;,
#&gt; #   relations &lt;chr&gt;, geodeticDatum &lt;chr&gt;, class &lt;chr&gt;, countryCode &lt;chr&gt;,
#&gt; #   country &lt;chr&gt;, rightsHolder &lt;chr&gt;, county &lt;chr&gt;, municipality &lt;chr&gt;,
#&gt; #   identificationVerificationStatus &lt;chr&gt;, gbifID &lt;chr&gt;, language &lt;chr&gt;,
#&gt; #   type &lt;chr&gt;, taxonID &lt;chr&gt;, occurrenceStatus &lt;chr&gt;,
#&gt; #   catalogNumber &lt;chr&gt;, vernacularName &lt;chr&gt;, institutionCode &lt;chr&gt;,
#&gt; #   taxonConceptID &lt;chr&gt;, eventTime &lt;chr&gt;, identifier &lt;chr&gt;,
#&gt; #   informationWithheld &lt;chr&gt;, endDayOfYear &lt;chr&gt;, locality &lt;chr&gt;,
#&gt; #   collectionCode &lt;chr&gt;, occurrenceID &lt;chr&gt;, recordedBy &lt;chr&gt;,
#&gt; #   startDayOfYear &lt;chr&gt;, datasetID &lt;chr&gt;, bibliographicCitation &lt;chr&gt;,
#&gt; #   accessRights &lt;chr&gt;, higherClassification &lt;chr&gt;, dateIdentified &lt;chr&gt;,
#&gt; #   elevation &lt;dbl&gt;, stateProvince &lt;chr&gt;, references &lt;chr&gt;,
#&gt; #   recordNumber &lt;chr&gt;, habitat &lt;chr&gt;, verbatimEventDate &lt;chr&gt;,
#&gt; #   associatedTaxa &lt;chr&gt;, verbatimLocality &lt;chr&gt;, verbatimElevation &lt;chr&gt;,
#&gt; #   identifiedBy &lt;chr&gt;, identificationID &lt;chr&gt;, occurrenceRemarks &lt;chr&gt;
</code></pre>

<p>Like many functions in <code>rgbif</code>, you can choose what to return with the <code>return</code> parameter, here, just returning the metadata:</p>

<pre><code class="language-r">occ_search(taxonKey=key, return='meta')
#&gt; # A tibble: 1 x 4
#&gt;   offset limit endOfRecords count
#&gt; *  &lt;int&gt; &lt;int&gt;        &lt;lgl&gt; &lt;int&gt;
#&gt; 1    300   200        FALSE 18310
</code></pre>

<p>You can choose what fields to return. This isn&rsquo;t passed on to the API query to GBIF as they don&rsquo;t allow that, but we filter out the columns before we give the data back to you.</p>

<pre><code class="language-r">occ_search(scientificName = &quot;Ursus americanus&quot;, fields=c('name','basisOfRecord','protocol'), limit = 20)
#&gt; Records found [9455]
#&gt; Records returned [20]
#&gt; No. unique hierarchies [1]
#&gt; No. media records [16]
#&gt; No. facets [0]
#&gt; Args [limit=20, offset=0, scientificName=Ursus americanus,
#&gt;      fields=name,basisOfRecord,protocol]
#&gt; # A tibble: 20 x 3
#&gt;                name    protocol     basisOfRecord
#&gt;               &lt;chr&gt;       &lt;chr&gt;             &lt;chr&gt;
#&gt;  1 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt;  2 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt;  3 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt;  4 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt;  5 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt;  6 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt;  7 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt;  8 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt;  9 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt; 10 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt; 11 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt; 12 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt; 13 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt; 14 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt; 15 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt; 16 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt; 17 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt; 18 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt; 19 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
#&gt; 20 Ursus americanus DWC_ARCHIVE HUMAN_OBSERVATION
</code></pre>

<p>Most parameters are vectorized, so you can pass in more than one value:</p>

<pre><code class="language-r">splist &lt;- c('Cyanocitta stelleri', 'Junco hyemalis', 'Aix sponsa')
keys &lt;- sapply(splist, function(x) name_suggest(x)$key[1], USE.NAMES=FALSE)
occ_search(taxonKey=keys, limit=5)
#&gt; Occ. found [2482598 (578358), 2492010 (3062104), 2498387 (978759)]
#&gt; Occ. returned [2482598 (5), 2492010 (5), 2498387 (5)]
#&gt; No. unique hierarchies [2482598 (1), 2492010 (1), 2498387 (1)]
#&gt; No. media records [2482598 (5), 2492010 (5), 2498387 (5)]
#&gt; No. facets [2482598 (0), 2492010 (0), 2498387 (0)]
#&gt; Args [limit=5, offset=0, taxonKey=2482598,2492010,2498387, fields=all]
#&gt; 3 requests; First 10 rows of data from 2482598
#&gt;
#&gt; # A tibble: 5 x 67
#&gt;                  name        key decimalLatitude decimalLongitude
#&gt;                 &lt;chr&gt;      &lt;int&gt;           &lt;dbl&gt;            &lt;dbl&gt;
#&gt; 1 Cyanocitta stelleri 1453342305        46.14702        -123.6545
#&gt; 2 Cyanocitta stelleri 1453373156        23.67272        -105.4548
#&gt; 3 Cyanocitta stelleri 1453355963        37.76899        -122.4758
#&gt; 4 Cyanocitta stelleri 1453325920        38.48213        -122.8734
#&gt; 5 Cyanocitta stelleri 1453338402        45.50661        -122.7135
#&gt; # ... with 63 more variables: issues &lt;chr&gt;, datasetKey &lt;chr&gt;,
#&gt; #   publishingOrgKey &lt;chr&gt;, publishingCountry &lt;chr&gt;, protocol &lt;chr&gt;,
#&gt; #   lastCrawled &lt;chr&gt;, lastParsed &lt;chr&gt;, crawlId &lt;int&gt;, extensions &lt;chr&gt;,
#&gt; #   basisOfRecord &lt;chr&gt;, taxonKey &lt;int&gt;, kingdomKey &lt;int&gt;,
#&gt; #   phylumKey &lt;int&gt;, classKey &lt;int&gt;, orderKey &lt;int&gt;, familyKey &lt;int&gt;,
#&gt; #   genusKey &lt;int&gt;, speciesKey &lt;int&gt;, scientificName &lt;chr&gt;, kingdom &lt;chr&gt;,
#&gt; #   phylum &lt;chr&gt;, order &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;, species &lt;chr&gt;,
#&gt; #   genericName &lt;chr&gt;, specificEpithet &lt;chr&gt;, taxonRank &lt;chr&gt;,
#&gt; #   dateIdentified &lt;chr&gt;, coordinateUncertaintyInMeters &lt;dbl&gt;, year &lt;int&gt;,
#&gt; #   month &lt;int&gt;, day &lt;int&gt;, eventDate &lt;chr&gt;, modified &lt;chr&gt;,
#&gt; #   lastInterpreted &lt;chr&gt;, references &lt;chr&gt;, license &lt;chr&gt;,
#&gt; #   identifiers &lt;chr&gt;, facts &lt;chr&gt;, relations &lt;chr&gt;, geodeticDatum &lt;chr&gt;,
#&gt; #   class &lt;chr&gt;, countryCode &lt;chr&gt;, country &lt;chr&gt;, rightsHolder &lt;chr&gt;,
#&gt; #   identifier &lt;chr&gt;, verbatimEventDate &lt;chr&gt;, datasetName &lt;chr&gt;,
#&gt; #   verbatimLocality &lt;chr&gt;, gbifID &lt;chr&gt;, collectionCode &lt;chr&gt;,
#&gt; #   occurrenceID &lt;chr&gt;, taxonID &lt;chr&gt;, catalogNumber &lt;chr&gt;,
#&gt; #   recordedBy &lt;chr&gt;, http...unknown.org.occurrenceDetails &lt;chr&gt;,
#&gt; #   institutionCode &lt;chr&gt;, rights &lt;chr&gt;, eventTime &lt;chr&gt;,
#&gt; #   identificationID &lt;chr&gt;, occurrenceRemarks &lt;chr&gt;,
#&gt; #   informationWithheld &lt;chr&gt;
</code></pre>

<h3 id="maps">Maps</h3>

<p>Static map using the ggplot2 package. Make a map of <em>Puma concolor</em> occurrences.</p>

<pre><code class="language-r">key &lt;- name_backbone(name='Puma concolor')$speciesKey
dat &lt;- occ_search(taxonKey=key, return='data', limit=300)
gbifmap(dat)
</code></pre>

<p><img src="/img/tutorial-images/rgbif/gbifmap1-1.png" alt="plot of chunk gbifmap1" /></p>

<h3 id="citing">Citing</h3>

<p>To cite <code>rgbif</code> in publications use:</p>

<blockquote>
<p>Scott Chamberlain, Carl Boettiger, Karthik Ram, Vijay Barve and Dan Mcglinn (2016). rgbif: Interface to the Global Biodiversity Information Facility API. R package version 0.9.3 <a href="https://github.com/ropensci/rgbif">https://github.com/ropensci/rgbif</a></p>
</blockquote>

<h3 id="license-and-bugs">License and bugs</h3>

<ul>
<li>License: <a href="http://opensource.org/licenses/MIT">MIT</a></li>
<li>Report bugs at <a href="https://github.com/ropensci/rgbif/issues?state=open">our Github repo for rgbif</a></li>
</ul>

<p><a href="#top">Back to top</a></p>

                    </article>
                </div>

                </div>
            </div>
        </div>
    </article>


    <div id="footer">
        <div class="container">
            <div class="row start">
                <div class="col-1 col-1-3 top-8">
                    <img src="/img/icon_short_white.svg" />
                </div>

                <div class="col-9 col-offset-2 top-10 bottom-8">
                    <div class="row between">
                        <div class="col-2 col-1-3">
                            <a href="http://github.com/ropensci" target="_blank"><div class="icon icon-github"></div></a>
                            <a href="http://twitter.com/ropensci" target="_blank"><div class="icon icon-twitter"></div></a>
                            <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon icon-vimeo"></div></a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Info</h5>
                                <li><a href="/about">Mission</a></li>
                                <li><a href="/about#team">Team</a></li>
                                <li><a href="/about#collaborators">Collaborators</a></li>
                                <li><a href="/careers">Careers</a></li>

                            </ul>
                        </div>

                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Work</h5>
                                <li><a href="/packages/">Packages</a></li>
                                <li><a href="/blog/">Blog</a></li>
                                <li><a href="/technotes/">Tech Notes</a></li>
                                <li><a href="/tutorials/">Tutorials</a></li>
                                <li><a href="/usecases/">Use Cases</a></li>
                                <li><a href="/resources/">More Resources</a></li>
                            </ul>
                        </div>
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Participate</h5>
                                <li><a href="/contact.html">Contact us</a></li>
                                <li><a href="/community/">Community</a></li>
                                <li><a href="http://onboarding.ropensci.org/">Contribute software</a></li>
                                <li><a href="http://unconf17.ropensci.org/">Unconference</a></li>
                                <li><a href="/coc">Code of conduct</a></li>
                                <li><a href="/donate/">Donate</a></li>
                            </ul>
                        </div>
                        <div class="col-4 top-8 bottom-8">
                            <h5 class="bottom-2"></h5>

                            <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                            <a href="http://numfocus.org" target="_blank"><img src="img/numfocus.png"></a>
                            <br>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 top-8 bottom-9 divider">
                    <p class="top-9">Except where otherwise noted, content on this site is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY license</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>




    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    

    
    <script type="text/javascript" src="/js/highlight.pack.js"></script>
    <script type="text/javascript">
        hljs.initHighlightingOnLoad();
    </script>



</body>
</html>
