<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Pdftools on rOpenSci - open tools for open science</title>
    <link>https://ropensci.org/tags/pdftools/</link>
    <description>Recent content in Pdftools on rOpenSci - open tools for open science</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Fri, 09 Dec 2016 00:00:00 +0000</lastBuildDate>
    
        <atom:link href="https://ropensci.org/tags/pdftools/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Announcing pdftools 1.0</title>
      <link>https://ropensci.org/technotes/2016/12/09/pdftools-10/</link>
      <pubDate>Fri, 09 Dec 2016 00:00:00 +0000</pubDate>
      
      <guid>https://ropensci.org/technotes/2016/12/09/pdftools-10/</guid>
      <description>
        
        

&lt;p&gt;This week we released version &lt;code&gt;1.0&lt;/code&gt; of the ropensci &lt;a href=&#34;https://cran.r-project.org/web/packages/pdftools/index.html&#34;&gt;pdftools&lt;/a&gt; package to CRAN. Pdftools provides utilities for extracting text, fonts, attachments and other data from PDF files. It also supports rendering of PDF files into bitmap images.&lt;/p&gt;

&lt;p&gt;This release has a few internal enhancements and fixes an annoying bug for landscape PDF pages. The version bump to &lt;code&gt;1.0&lt;/code&gt; signifies that the package has undergone sufficient testing and the API is stable.&lt;/p&gt;

&lt;h2 id=&#34;extracting-text&#34;&gt;Extracting Text&lt;/h2&gt;

&lt;p&gt;As described in our previous &lt;a href=&#34;https://ropensci.org/blog/blog/2016/03/01/pdftools-and-jeroen&#34;&gt;post&lt;/a&gt;, the most common use of &lt;code&gt;pdftools&lt;/code&gt; is extracting text from (scientific) articles for searching / indexing. But let&amp;rsquo;s try a somewhat more unusual PDF file this time: a poster.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(pdftools)
url &amp;lt;- &amp;quot;https://www.rstudio.com/wp-content/uploads/2016/02/advancedR.pdf&amp;quot;

# Display author, editor
pdf_info(url)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;pdf_info&lt;/code&gt; file returns all kind of metadata from the pdf file. For example we can read that this PDF was created on 2016-02-12 by Arianne Colton using Acrobat PDFMaker 11 for PowerPoint.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# extract text vector
text &amp;lt;- pdf_text(url)

# Print text from page 1
cat(text[1])
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;pdf_text&lt;/code&gt; function extracts text into an R character vector if length equal to the number of pages in the PDF.
Note how the text is spaced to match the position in the PDF page.&lt;/p&gt;

&lt;h2 id=&#34;rendering-pdf&#34;&gt;Rendering PDF&lt;/h2&gt;

&lt;p&gt;Recent versions of pdftools allow rendering of PDF pages into bitmap images. The &lt;code&gt;pdf_render_page&lt;/code&gt; function returns the bitmap as a raw vector array of size channels * width * height (in pixels).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(pdftools)
bitmap &amp;lt;- pdf_render_page(url, page = 1, dpi = 72)
dim(bitmap)
### 4 1100  850
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;From here we can use for example the rOpenSci &lt;a href=&#34;https://cran.r-project.org/web/packages/magick/vignettes/intro.html&#34;&gt;magick&lt;/a&gt; package to read the bitmap and manipulate/export it to various formats.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(magick)
poster &amp;lt;- image_read(bitmap)
print(poster)
image_write(poster, &amp;quot;out.png&amp;quot;, format = &amp;quot;png&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Or have some fun with the other magick tools :)&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# Download dancing banana
banana &amp;lt;- image_read(&amp;quot;https://jeroen.github.io/images/banana.gif&amp;quot;)
banana &amp;lt;- image_scale(banana, &amp;quot;300&amp;quot;)

# Combine and flatten frames
frames &amp;lt;- lapply(banana, function(frame) {
  image_composite(poster, frame, offset = &amp;quot;+70+30&amp;quot;)
})

# Turn frames into animation
animation &amp;lt;- image_animate(image_join(frames))
print(animation)

# Save as gif
image_write(animation, &amp;quot;output.gif&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

      </description>
    </item>
    
    <item>
      <title>Introducing pdftools - A fast and portable PDF extractor</title>
      <link>https://ropensci.org/blog/2016/03/01/pdftools-and-jeroen/</link>
      <pubDate>Tue, 01 Mar 2016 00:00:00 +0000</pubDate>
      
      <guid>https://ropensci.org/blog/2016/03/01/pdftools-and-jeroen/</guid>
      <description>
        
        

&lt;p&gt;Scientific articles are typically locked away in PDF format, a format designed primarily for printing but not so great for searching or indexing. The new &lt;a href=&#34;https://cran.r-project.org/package=pdftools&#34;&gt;pdftools&lt;/a&gt; package allows for extracting text and metadata from pdf files in R. From the extracted plain-text one could find articles discussing a particular drug or species name, without having to rely on publishers providing metadata, or pay-walled search engines.&lt;/p&gt;

&lt;p&gt;The pdftools slightly overlaps with the &lt;a href=&#34;https://cran.r-project.org/web/packages/Rpoppler/index.html&#34;&gt;Rpoppler&lt;/a&gt; package by Kurt Hornik. The main motivation behind developing pdftools was that Rpoppler depends on glib, which does not work well on Mac and Windows. The pdftools package uses the poppler c++ interface together with Rcpp, which results in a lighter and more portable implementation.&lt;/p&gt;

&lt;h2 id=&#34;installing-pdftools&#34;&gt;Installing pdftools&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;https://cran.rstudio.com/web/packages/pdftools/&#34;&gt;&lt;span class=&#34;label label-warning&#34;&gt;cran&lt;/span&gt;&lt;/a&gt; &lt;a href=&#34;https://github.com/ropensci/pdftools&#34;&gt;&lt;span class=&#34;label label-info&#34;&gt;github&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;On Windows and Mac the binary packages can be installed directly from CRAN:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;install.packages(&amp;quot;pdftools&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Installation on Linux requires the poppler development library. On Debian/Ubuntu:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo apt-get install libpoppler-cpp-dev
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;On Fedora or CentOS:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo yum install poppler-cpp-devel
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you want to install the package from source on Mac OS-X you need brew:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;brew install poppler
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That&amp;rsquo;s it.&lt;/p&gt;

&lt;h2 id=&#34;getting-started&#34;&gt;Getting started&lt;/h2&gt;

&lt;p&gt;The &lt;code&gt;?pdftools&lt;/code&gt; manual page shows a brief overview of the main utilities. The most important function is &lt;code&gt;pdf_text&lt;/code&gt; which returns a character vector of length equal to the number of pages in the pdf. Each string in the vector contains a plain text version of the text on that page.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(pdftools)
download.file(&amp;quot;http://arxiv.org/pdf/1403.2805.pdf&amp;quot;, &amp;quot;1403.2805.pdf&amp;quot;, mode = &amp;quot;wb&amp;quot;)
txt &amp;lt;- pdf_text(&amp;quot;1403.2805.pdf&amp;quot;)

# first page text
cat(txt[1])

# second page text
cat(txt[2])
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In addition, the package has some utilities to extract other data from the PDF file. The &lt;code&gt;pdf_toc&lt;/code&gt; function shows the table of contents, i.e. the section headers which pdf readers usually display in a menu on the left. It looks pretty in JSON:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# Table of contents
toc &amp;lt;- pdf_toc(&amp;quot;1403.2805.pdf&amp;quot;)

# Show as JSON
jsonlite::toJSON(toc, auto_unbox = TRUE, pretty = TRUE)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Other functions provide information about fonts, attachments and metadata such as the author, creation date or tags.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# Author, version, etc
info &amp;lt;- pdf_info(&amp;quot;1403.2805.pdf&amp;quot;)

# Table with fonts
fonts &amp;lt;- pdf_fonts(&amp;quot;1403.2805.pdf&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;bonus-feature-rendering-pdf&#34;&gt;Bonus feature: rendering pdf&lt;/h2&gt;

&lt;p&gt;A bonus feature on most platforms is rendering of PDF files to bitmap arrays. The poppler library provides all functionality to implement a complete PDF reader, including graphical display of the content. In R we can use pdf_render_page to render a page of the PDF into a bitmap, which can be stored as e.g. png or jpeg.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;# renders pdf to bitmap array
bitmap &amp;lt;- pdf_render_page(&amp;quot;1403.2805.pdf&amp;quot;, page = 1)

# save bitmap image
png::writePNG(bitmap, &amp;quot;page.png&amp;quot;)
jpeg::writeJPEG(bitmap, &amp;quot;page.jpeg&amp;quot;)
webp::write_webp(bitmap, &amp;quot;page.webp&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This feature now works on all platforms.&lt;/p&gt;

&lt;h2 id=&#34;limitations&#34;&gt;Limitations&lt;/h2&gt;

&lt;p&gt;Data scientists are often interested in data from tables. Unfortunately the pdf format is pretty dumb and does not have notion of a table (unlike for example HTML). Tabular data in a pdf file is nothing more than strategically positioned lines and text, which makes it difficult to extract the raw data.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;txt &amp;lt;- pdf_text(&amp;quot;http://arxiv.org/pdf/1406.4806.pdf&amp;quot;)

# some tables
cat(txt[18])
cat(txt[19])
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Pdftools usually does a decent job in retaining the positioning of table elements when converting from pdf to text. But the output is still very dependent on the formatting of the original pdf table, which makes it very difficult to write a generic table extractor. But with a little creativity you might be able to parse the table data from the text output of a given paper.&lt;/p&gt;

&lt;h2 id=&#34;jeroen-ooms-joins-team-ropensci&#34;&gt;Jeroen Ooms joins team rOpenSci!&lt;/h2&gt;

&lt;p&gt;A message from the team: We are happy to announce that &lt;a href=&#34;https://jeroen.github.io/&#34;&gt;Jeroen Ooms&lt;/a&gt; has joined the rOpenSci crew! Jeroen is a prolific programmer and author of numerous &lt;a href=&#34;https://cran.r-project.org/web/checks/check_results_jeroen.ooms_at_stat.ucla.edu.html&#34;&gt;widely used packages&lt;/a&gt;. At rOpenSci, he will continue to work on developing awesome packages and infrastructural software for improving the scientific tool chain.&lt;/p&gt;

      </description>
    </item>
    
  </channel>
</rss>
