<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>rOpenSci | Random GeoJSON and WKT with randgeo</title>

     
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>

    <script type="text/javascript">
    hljs.configure({languages: []});
    hljs.initHighlightingOnLoad();
    </script>
    <link rel="stylesheet" type="text/css" href="/css/style-new.css" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#4b8add">
<meta name="theme-color" content="#4b8add">


    <meta name="viewport" content="width=device-width, initial-scale=1">

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-462421-6', 'auto');
ga('send', 'pageview');
</script>

</head>
<body>

    
    <div id="header">
        <div class="container">
            <div class="row center-m">
                
                <div class="col-1">
                    <a href="/index.html"><img src="/img/icon_lettering_white.svg" /></a>
                </div>
                
                
                <nav class="col-6 col-offset-4 top-3">
                    <ul class="row between">
						<li><a href="/about/">About</a></li>
                        <li><a href="/blog/">Blog</a></li>
                        <li><a href="/packages/">Packages</a></li>
                        <li><a href="/community/">Community</a></li>
                        <li><a href="http://discuss.ropensci.org/" target="_blank">Discuss</a></li>

                    </ul>
                </nav>
                
            </div>
        </div>
    </div>


<article class="blog-post">
    <div class="container">
        <div class="row">
            <div class="col-2 sidebar top-5">
                <ul class="autoSidebar"></ul>
            </div> 
        </div>
        <div class="row">
            <div class="col-offset-2 col-8 top-20">
                <h1 style="text-align: center;">Random GeoJSON and WKT with randgeo</h1>
            </div>
        </div>
        <div class="row">
            <div class="col-offset-2 col-8 top-10 bottom-5" style="font-size: 20px; text-align: center;">
                <p class="authors" style="text-align: center;">
                    
                        &nbsp;
                        
                          <a href="/about/#team">Scott Chamberlain</a> 
                        
                        
                        &nbsp; |
                    
                        &nbsp;
                        
                          <a href="http://www.noamross.net" target="_blank">Noam Ross</a>
                        
                        
                        &nbsp; |
                    
                    <small style="color: #5B617A; margin-left: 10px;"> APRIL 20, 2017</small>
                </p>
            </div>
            <div class="col-offset-2 col-8 top-2">
                

<p><strong>randgeo</strong> generates random points and shapes in GeoJSON and WKT formats for
use in examples, teaching, or statistical applications.</p>

<p>Points and shapes are generated in the long/lat coordinate system and with
appropriate spherical geometry; random points are distributed evenly across
the globe, and random shapes are sized according to a maximum great-circle
distance from the center of the shape.</p>

<p><strong>randgeo</strong> was adapted from <a href="https://github.com/tmcw/geojson-random">https://github.com/tmcw/geojson-random</a> to have
a pure R implementation without any dependencies as well as appropriate
geometry. Data generated by <strong>randgeo</strong> may be processed or displayed of with
packages such as <a href="https://cran.r-project.org/package=sf"><strong>sf</strong></a>,
<a href="https://cran.r-project.org/package=wicket"><strong>wicket</strong></a>,
<a href="https://cran.r-project.org/package=geojson"><strong>geojson</strong></a>,
<a href="https://cran.r-project.org/package=wellknown"><strong>wellknown</strong></a>,
<a href="https://cran.r-project.org/package=geojsonio"><strong>geojsonio</strong></a>, or
<a href="https://cran.r-project.org/package=lawn"><strong>lawn</strong></a>.</p>

<p>Package API:</p>

<ul>
<li><code>rg_position</code> - random position (lon, lat)</li>
<li><code>geo_point</code> - random GeoJSON point</li>
<li><code>geo_polygon</code> - random GeoJSON polygon</li>
<li><code>wkt_point</code> - random WKT point</li>
<li><code>wkt_polygon</code> - random WKT polygon</li>
</ul>

<h2 id="setup">Setup</h2>

<p>Install <code>randgeo</code> - and we&rsquo;ll need a few other packages for examples below.</p>

<pre><code class="language-r">install.packages(&quot;randgeo&quot;)
install.packages(c('leaflet', 'lawn'))
</code></pre>

<pre><code class="language-r">library(randgeo)
</code></pre>

<p>Functions that start with <code>geo</code> are for creating GeoJSON data in JSON format.
If you want to create an R list or data.frame, you can use <code>jsonlite::fromJSON</code>.</p>

<h2 id="random">Random</h2>

<p>Evenly distributed across the sphere.  The <code>bbox</code> option allows
you to limit points to within long/lat bounds.</p>

<pre><code class="language-r">geo_point()
#&gt; $type
#&gt; [1] &quot;FeatureCollection&quot;
#&gt;
#&gt; $features
#&gt; $features[[1]]
#&gt; $features[[1]]$type
#&gt; [1] &quot;Feature&quot;
#&gt;
#&gt; $features[[1]]$geometry
#&gt; $features[[1]]$geometry$type
#&gt; [1] &quot;Point&quot;
#&gt;
#&gt; $features[[1]]$geometry$coordinates
#&gt; [1] 105.95999 -46.58477
#&gt;
#&gt;
#&gt; $features[[1]]$properties
#&gt; NULL
#&gt;
#&gt;
#&gt;
#&gt; attr(,&quot;class&quot;)
#&gt; [1] &quot;geo_list&quot;
</code></pre>

<p>Centered on a random point, with default maximum size</p>

<pre><code class="language-r">geo_polygon()
#&gt; $type
#&gt; [1] &quot;FeatureCollection&quot;
#&gt;
#&gt; $features
#&gt; $features[[1]]
#&gt; $features[[1]]$type
#&gt; [1] &quot;Feature&quot;
#&gt;
#&gt; $features[[1]]$geometry
#&gt; $features[[1]]$geometry$type
#&gt; [1] &quot;Polygon&quot;
#&gt;
#&gt; $features[[1]]$geometry$coordinates
#&gt; $features[[1]]$geometry$coordinates[[1]]
#&gt; $features[[1]]$geometry$coordinates[[1]][[1]]
#&gt; [1] -138.49434  -25.11895
#&gt;
#&gt; $features[[1]]$geometry$coordinates[[1]][[2]]
#&gt; [1] -145.95566  -28.17623
#&gt;
#&gt; $features[[1]]$geometry$coordinates[[1]][[3]]
#&gt; [1] -145.87817  -28.74364
#&gt;
#&gt; $features[[1]]$geometry$coordinates[[1]][[4]]
#&gt; [1] -146.61325  -28.59748
#&gt;
#&gt; $features[[1]]$geometry$coordinates[[1]][[5]]
#&gt; [1] -139.18167  -31.07703
#&gt;
#&gt; $features[[1]]$geometry$coordinates[[1]][[6]]
#&gt; [1] -140.88748  -31.24708
#&gt;
#&gt; $features[[1]]$geometry$coordinates[[1]][[7]]
#&gt; [1] -143.50402  -33.93551
#&gt;
#&gt; $features[[1]]$geometry$coordinates[[1]][[8]]
#&gt; [1] -146.48114  -30.43185
#&gt;
#&gt; $features[[1]]$geometry$coordinates[[1]][[9]]
#&gt; [1] -144.68315  -35.45465
#&gt;
#&gt; $features[[1]]$geometry$coordinates[[1]][[10]]
#&gt; [1] -157.58084  -24.52897
#&gt;
#&gt; $features[[1]]$geometry$coordinates[[1]][[11]]
#&gt; [1] -138.49434  -25.11895
#&gt;
#&gt;
#&gt;
#&gt;
#&gt; $features[[1]]$properties
#&gt; NULL
#&gt;
#&gt;
#&gt;
#&gt; attr(,&quot;class&quot;)
#&gt; [1] &quot;geo_list&quot;
</code></pre>

<p>Visualize your shapes with <strong>lawn</strong>.</p>

<pre><code class="language-r">lawn::view(jsonlite::toJSON(unclass(geo_polygon(count = 4)), auto_unbox = TRUE))
</code></pre>

<p><img src="/assets/blog-images/2017-04-20-randgeo/plot1.png" alt="map" /></p>

<h2 id="wkt">WKT</h2>

<p>Functions prefixed with <code>wkt</code> create random Well-Known Text (WKT) data. These functions
wrap the GeoJSON versions, but then convert the data to WKT.</p>

<p>Random point:</p>

<pre><code class="language-r">wkt_point()
#&gt; [1] &quot;POINT (179.8795330 -29.1106238)&quot;
</code></pre>

<p>Random polygon:</p>

<pre><code class="language-r">wkt_polygon()
#&gt; [1] &quot;POLYGON ((-60.0870329 -12.9315478, -61.5073816 -25.3204334, -62.6987366 -24.5766272, -64.1853669 -24.0497260, -67.7152546 -27.4752321, -68.4190340 -26.9510818, -67.6018452 -21.5489551, -64.3083560 -21.6772242, -63.1471630 -21.9415438, -64.1137279 -14.2398013, -60.0870329 -12.9315478))&quot;
</code></pre>

<h2 id="use-case">Use case</h2>

<p>Example of geospatial data manipulation, using <code>randgeo</code>, <code>leaflet</code> and
<code>lawn</code>.</p>

<p>Steps:</p>

<ul>
<li>Generate random overlapping polygons</li>
<li>Calculate a single polygon from overlapping polygons</li>
<li>Map polygon</li>
<li>Generate random locaitons (points)</li>
<li>Clip locations to the polygon</li>
<li>Overlay locations (more random points) on the polygon</li>
</ul>

<pre><code class="language-r">library(randgeo)
library(lawn)
library(leaflet)
</code></pre>

<p>generate random data</p>

<pre><code class="language-r">set.seed(5)
polys &lt;- randgeo::geo_polygon(count = 2, num_vertices = 4, bbox = c(-120, 40, -100, 50))
</code></pre>

<p>Get intersection of polygons</p>

<pre><code class="language-r">polysinter &lt;- lawn::lawn_intersect(polys$features[[1]], polys$features[[2]])
</code></pre>

<p>Map polygons</p>

<pre><code class="language-r">polysinter %&gt;% lawn::view()
</code></pre>

<p><img src="/assets/blog-images/2017-04-20-randgeo/plot2.png" alt="map" /></p>

<p>Generate random points - clip points to polygon</p>

<pre><code class="language-r">pts &lt;- randgeo::geo_point(count = 500, bbox = c(-120, 40, -100, 50))
pts &lt;- lawn::lawn_within(
  points = lawn_featurecollection(pts),
  polygons = lawn_featurecollection(polysinter)
)
</code></pre>

<p>Draw polygon + points on map</p>

<pre><code class="language-r">polysinter %&gt;%
  view() %&gt;%
  addGeoJSON(geojson = jsonlite::toJSON(unclass(pts)))
</code></pre>

<p><img src="/assets/blog-images/2017-04-20-randgeo/plot3.png" alt="map" /></p>

<h2 id="feedback">Feedback</h2>

<p>Let us know what you think!  <code>randgeo</code> doesn&rsquo;t have any revdep&rsquo;s on CRAN yet, but
is being <a href="https://github.com/search?utf8=%E2%9C%93&amp;q=%22randgeo%22+language%3AR+-user%3Acran+-user%3Aropensci&amp;type=Code">used in one package on GitHub</a>.</p>

            </div>
            <br>


            
            
            <div class="col-offset-2 col-8 top-4">
                <div id='discourse-comments'></div>
                <script type="text/javascript">
                DiscourseEmbed = { discourseUrl: 'https://discuss.ropensci.org/',
                                   topicId:  665  };
                (function() {
                  var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true;
                  d.src = DiscourseEmbed.discourseUrl + 'javascripts/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d);
                })();
                </script>
            </div>
            
        </div>
        <br>
    </div>
</article>





    <div id="footer">
        <div class="container">
            <div class="row start">
                <div class="col-1 col-1-3 top-8">
                    <img src="/img/icon_short_white.svg" />
                </div>

                <div class="col-9 col-offset-2 top-10 bottom-8">
                    <div class="row between">
                        <div class="col-2 col-1-3">
                            <a href="http://github.com/ropensci" target="_blank"><div class="icon icon-github"></div></a>
                            <a href="http://twitter.com/ropensci" target="_blank"><div class="icon icon-twitter"></div></a>
                            <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon icon-vimeo"></div></a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Info</h5>
                                <li><a href="/about">Mission</a></li>
                                <li><a href="/about#team">Team</a></li>
                                <li><a href="/about#collaborators">Collaborators</a></li>
                                <li><a href="/careers">Careers</a></li>

                            </ul>
                        </div>

                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Work</h5>
                                <li><a href="/packages/">Packages</a></li>
                                <li><a href="/blog/">Blog</a></li>
                                <li><a href="/technotes/">Tech Notes</a></li>
                                <li><a href="/tutorials/">Tutorials</a></li>
                                <li><a href="/usecases/">Use Cases</a></li>
                                <li><a href="/resources/">More Resources</a></li>
                            </ul>
                        </div>
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Participate</h5>
                                <li><a href="/contact.html">Contact us</a></li>
                                <li><a href="/community/">Community</a></li>
                                <li><a href="http://onboarding.ropensci.org/">Contribute software</a></li>
                                <li><a href="http://unconf17.ropensci.org/">Unconference</a></li>
                                <li><a href="/coc">Code of conduct</a></li>
                                <li><a href="/donate/">Donate</a></li>
                            </ul>
                        </div>
                        <div class="col-4 top-8 bottom-8">
                            <h5 class="bottom-2"></h5>

                            <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                            <a href="http://numfocus.org" target="_blank"><img src="img/numfocus.png"></a>
                            <br>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 top-8 bottom-9 divider">
                    <p class="top-9">Except where otherwise noted, content on this site is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY license</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>



</body>
</html>



