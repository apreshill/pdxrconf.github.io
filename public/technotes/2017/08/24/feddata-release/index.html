<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>rOpenSci | FedData - Getting assorted geospatial data into R</title>

     
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>

    <script type="text/javascript">
    hljs.configure({languages: []});
    hljs.initHighlightingOnLoad();
    </script>
    <link rel="stylesheet" type="text/css" href="/css/style-new.css" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#4b8add">
<meta name="theme-color" content="#4b8add">


    <meta name="viewport" content="width=device-width, initial-scale=1">

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-462421-6', 'auto');
ga('send', 'pageview');
</script>

</head>
<body>

    
    <div id="header">
        <div class="container">
            <div class="row center-m">
                
                <div class="col-1">
                    <a href="/index.html"><img src="/img/icon_lettering_white.svg" /></a>
                </div>
                
                
                <nav class="col-6 col-offset-4 top-3">
                    <ul class="row between">
						<li><a href="/about/">About</a></li>
                        <li><a href="/blog/">Blog</a></li>
                        <li><a href="/packages/">Packages</a></li>
                        <li><a href="/community/">Community</a></li>
                        <li><a href="http://discuss.ropensci.org/" target="_blank">Discuss</a></li>

                    </ul>
                </nav>
                
            </div>
        </div>
    </div>


<article class="blog-post">
    <div class="container">
        <div class="row">
            <div class="col-2 sidebar top-5">
                <ul class="autoSidebar"></ul>
            </div> 
        </div>
        <div class="row">
            <div class="col-offset-2 col-8 top-20">
                <h1 style="text-align: center;">FedData - Getting assorted geospatial data into R</h1>
            </div>
        </div>
        <div class="row">
            <div class="col-offset-2 col-8 top-10 bottom-5" style="font-size: 20px; text-align: center;">
                <p class="authors" style="text-align: center;">
                    
                        &nbsp;
                        
                          <a href="https://github.com/bocinsky" target="_blank">Kyle Bocinsky</a>
                        
                        
                        &nbsp; |
                    
                    <small style="color: #5B617A; margin-left: 10px;"> AUGUST 24, 2017</small>
                </p>
            </div>
            <div class="col-offset-2 col-8 top-2">
                

<p>The package <a href="https://github.com/ropensci/FedData"><code>FedData</code></a> has gone through software review and is now part of <a href="https://ropensci.org/">rOpenSci</a>. <code>FedData</code> includes functions to automate downloading geospatial data available from several federated data sources (mainly sources maintained by the US Federal government).</p>

<p>Currently, the package enables extraction from six datasets:</p>

<ul>
<li>The <a href="http://ned.usgs.gov">National Elevation Dataset (NED)</a> digital elevation models (1 and <sup>1</sup>&frasl;<sub>3</sub> arc-second; USGS)</li>
<li>The <a href="http://nhd.usgs.gov">National Hydrography Dataset (NHD)</a> (USGS)</li>
<li>The <a href="http://websoilsurvey.sc.egov.usda.gov/">Soil Survey Geographic (SSURGO) database</a> from the National Cooperative Soil Survey (NCSS), which is led by the Natural Resources Conservation Service (NRCS) under the USDA,</li>
<li>The <a href="http://www.ncdc.noaa.gov/data-access/land-based-station-data/land-based-datasets/global-historical-climatology-network-ghcn">Global Historical Climatology Network (GHCN)</a>, coordinated by National Climatic Data Center at NOAA,</li>
<li>The <a href="https://daymet.ornl.gov/">Daymet</a> gridded estimates of daily weather parameters for North America, version 3, available from the Oak Ridge National Laboratory&rsquo;s Distributed Active Archive Center (DAAC), and</li>
<li>The <a href="http://www.ncdc.noaa.gov/data-access/paleoclimatology-data/datasets/tree-ring">International Tree Ring Data Bank (ITRDB)</a>, coordinated by National Climatic Data Center at NOAA.</li>
</ul>

<p><code>FedData</code> is designed with the large-scale geographic information system (GIS) use-case in mind: cases where the use of dynamic web-services is impractical due to the scale (spatial and/or temporal) of analysis. It functions primarily as a means of downloading tiled or otherwise spatially-defined datasets; additionally, it can preprocess those datasets by extracting data within an area of interest (AoI), defined spatially. It relies heavily on the <a href="https://cran.r-project.org/package=sp"><code>sp</code></a>, <a href="https://cran.r-project.org/package=raster"><code>raster</code></a>, and <a href="https://cran.r-project.org/package=rgdal"><code>rgdal</code></a> packages.</p>

<h2 id="examples">Examples</h2>

<p>Load <code>FedData</code> and define a study area</p>

<pre><code class="language-r"># FedData Tester
library(FedData)
library(magrittr)

# Extract data for the Village Ecodynamics Project &quot;VEPIIN&quot; study area:
# http://veparchaeology.org
vepPolygon &lt;- polygon_from_extent(raster::extent(672800, 740000, 4102000, 4170000),
                                  proj4string = &quot;+proj=utm +datum=NAD83 +zone=12&quot;)
</code></pre>

<p>Get and plot the National Elevation Dataset for the study area</p>

<pre><code class="language-r"># Get the NED (USA ONLY)
# Returns a raster
NED &lt;- get_ned(template = vepPolygon,
               label = &quot;VEPIIN&quot;)
# Plot with raster::plot
raster::plot(NED)
</code></pre>

<p><img src="https://github.com/ropensci/FedData/raw/master/inst/image/README-unnamed-chunk-6-1.png" alt="" /></p>

<p>Get and plot the Daymet dataset for the study area</p>

<pre><code class="language-r"># Get the DAYMET (North America only)
# Returns a raster
DAYMET &lt;- get_daymet(template = vepPolygon,
               label = &quot;VEPIIN&quot;,
               elements = c(&quot;prcp&quot;,&quot;tmax&quot;),
               years = 1980:1985)
# Plot with raster::plot
raster::plot(DAYMET$tmax$X1985.10.23)
</code></pre>

<p><img src="https://github.com/ropensci/FedData/raw/master/inst/image/README-unnamed-chunk-7-1.png" alt="" /></p>

<p>Get and plot the daily GHCN precipitation data for the study area</p>

<pre><code class="language-r"># Get the daily GHCN data (GLOBAL)
# Returns a list: the first element is the spatial locations of stations,
# and the second is a list of the stations and their daily data
GHCN.prcp &lt;- get_ghcn_daily(template = vepPolygon,
                            label = &quot;VEPIIN&quot;,
                            elements = c('prcp'))
# Plot the NED again
raster::plot(NED)
# Plot the spatial locations
sp::plot(GHCN.prcp$spatial,
         pch = 1,
         add = TRUE)
legend('bottomleft',
       pch = 1,
       legend=&quot;GHCN Precipitation Records&quot;)
</code></pre>

<p><img src="https://github.com/ropensci/FedData/raw/master/inst/image/README-unnamed-chunk-8-1.png" alt="" /></p>

<p>Get and plot the daily GHCN temperature data for the study area</p>

<pre><code class="language-r"># Elements for which you require the same data
# (i.e., minimum and maximum temperature for the same days)
# can be standardized using standardize==T
GHCN.temp &lt;- get_ghcn_daily(template = vepPolygon,
                            label = &quot;VEPIIN&quot;,
                            elements = c('tmin','tmax'),
                            years = 1980:1985,
                            standardize = TRUE)
# Plot the NED again
raster::plot(NED)
# Plot the spatial locations
sp::plot(GHCN.temp$spatial,
         add = TRUE,
         pch = 1)
legend('bottomleft',
       pch = 1,
       legend = &quot;GHCN Temperature Records&quot;)
</code></pre>

<p><img src="https://github.com/ropensci/FedData/raw/master/inst/image/README-unnamed-chunk-9-1.png" alt="" /></p>

<p>Get and plot the National Hydrography Dataset for the study area</p>

<pre><code class="language-r"># Get the NHD (USA ONLY)
NHD &lt;- get_nhd(template = vepPolygon,
               label = &quot;VEPIIN&quot;)
# Plot the NED again
raster::plot(NED)
# Plot the NHD data
NHD %&gt;%
  lapply(sp::plot,
         col = 'black',
         add = TRUE)
</code></pre>

<p><img src="https://github.com/ropensci/FedData/raw/master/inst/image/README-unnamed-chunk-10-1.png" alt="" /></p>

<p>Get and plot the NRCS SSURGO data for the study area</p>

<pre><code class="language-r"># Get the NRCS SSURGO data (USA ONLY)
SSURGO.VEPIIN &lt;- get_ssurgo(template = vepPolygon,
                     label = &quot;VEPIIN&quot;)
#&gt; Warning: 1 parsing failure.
#&gt; row # A tibble: 1 x 5 col     row     col               expected actual expected   &lt;int&gt;   &lt;chr&gt;                  &lt;chr&gt;  &lt;chr&gt; actual 1  1276 slope.r no trailing characters     .5 file # ... with 1 more variables: file &lt;chr&gt;
# Plot the NED again
raster::plot(NED)
# Plot the SSURGO mapunit polygons
plot(SSURGO.VEPIIN$spatial,
     lwd = 0.1,
     add = TRUE)
</code></pre>

<p><img src="https://github.com/ropensci/FedData/raw/master/inst/image/README-unnamed-chunk-11-1.png" alt="" /></p>

<p>Get and plot the NRCS SSURGO data for particular soil survey areas</p>

<pre><code class="language-r"># Or, download by Soil Survey Area names
SSURGO.areas &lt;- get_ssurgo(template = c(&quot;CO670&quot;,&quot;CO075&quot;),
                           label = &quot;CO_TEST&quot;)

# Let's just look at spatial data for CO675
SSURGO.areas.CO675 &lt;- SSURGO.areas$spatial[SSURGO.areas$spatial$AREASYMBOL==&quot;CO075&quot;,]

# And get the NED data under them for pretty plotting
NED.CO675 &lt;- get_ned(template = SSURGO.areas.CO675,
                            label = &quot;SSURGO_CO675&quot;)

# Plot the SSURGO mapunit polygons, but only for CO675
plot(NED.CO675)
plot(SSURGO.areas.CO675,
     lwd = 0.1,
     add = TRUE)
</code></pre>

<p><img src="https://github.com/ropensci/FedData/raw/master/inst/image/README-unnamed-chunk-12-1.png" alt="" /></p>

<p>Get and plot the ITRDB chronology locations in the study area</p>

<pre><code class="language-r"># Get the ITRDB records
ITRDB &lt;- get_itrdb(template = vepPolygon,
                        label = &quot;VEPIIN&quot;,
                        makeSpatial = TRUE)
# Plot the NED again
raster::plot(NED)
# Map the locations of the tree ring chronologies
plot(ITRDB$metadata,
     pch = 1,
     add = TRUE)
legend('bottomleft',
       pch = 1,
       legend = &quot;ITRDB chronologies&quot;)
</code></pre>

<p><img src="https://github.com/ropensci/FedData/raw/master/inst/image/README-unnamed-chunk-13-1.png" alt="" /></p>

<h2 id="todo">TODO</h2>

<p><strong>The current CRAN version of <code>FedData</code>, v2.4.6, will (hopefully) be the final CRAN release of <code>FedData</code> 2. <code>FedData</code> 3 will be released in the coming months, but some code built on <code>FedData</code> 2 will not be compatible with FedData 3.</strong></p>

<p><code>FedData</code> was initially developed prior to widespread use of modern web mapping services and RESTful APIs by many Federal data-holders. Future releases of <code>FedData</code> will limit data transfer by utilizing server-side geospatial and data queries. We will also implement <a href="https://github.com/hadley/dplyr"><code>dplyr</code></a> verbs, tidy data structures, (<a href="https://github.com/tidyverse/magrittr"><code>magrittr</code></a>) piping, functional programming using <a href="https://github.com/hadley/purrr"><code>purrr</code></a>, simple features for spatial data from <a href="https://github.com/edzer/sfr"><code>sf</code></a>, and local data storage in OGC-compliant data formats (probably GeoJSON and NetCDF). I am also aiming for 100% testing coverage.</p>

<p>All that being said, much of the functionality of the <code>FedData</code> package could be spun off into more domain-specific packages. For example, ITRDB download functions could be part of the <a href="https://r-forge.r-project.org/projects/dplr/"><code>dplR</code></a> dendrochronology package; concepts/functions having to do with the GHCN data integrated into <a href="https://github.com/ropensci/rnoaa"><code>rnoaa</code></a>; and Daymet concepts integrated into <a href="https://github.com/khufkens/daymetr"><code>daymetr</code></a>. I welcome any and all suggestions about how to improve the utility of FedData; please <a href="https://github.com/ropensci/FedData/issues">submit an issue</a>.</p>

<h2 id="acknowledgements">Acknowledgements</h2>

<p><code>FedData</code> is a product of SKOPE (<a href="http://www.openskope.org">Synthesizing Knowledge of Past Environments</a>) and the <a href="http://veparchaeology.org/">Village Ecodynamics Project</a>.</p>

<p><code>FedData</code> was reviewed for <a href="https://ropensci.org">rOpenSci</a> by <a href="https://github.com/jooolia">@jooolia</a>, with <a href="https://github.com/sckott">@sckott</a> as onboarding editor, and was greatly improved as a result.</p>

            </div>
            <br>


            
            
            <div class="col-offset-2 col-8 top-4">
                <div id='discourse-comments'></div>
                <script type="text/javascript">
                DiscourseEmbed = { discourseUrl: 'https://discuss.ropensci.org/',
                                   topicId:  840  };
                (function() {
                  var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true;
                  d.src = DiscourseEmbed.discourseUrl + 'javascripts/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d);
                })();
                </script>
            </div>
            
        </div>
        <br>
    </div>
</article>





    <div id="footer">
        <div class="container">
            <div class="row start">
                <div class="col-1 col-1-3 top-8">
                    <img src="/img/icon_short_white.svg" />
                </div>

                <div class="col-9 col-offset-2 top-10 bottom-8">
                    <div class="row between">
                        <div class="col-2 col-1-3">
                            <a href="http://github.com/ropensci" target="_blank"><div class="icon icon-github"></div></a>
                            <a href="http://twitter.com/ropensci" target="_blank"><div class="icon icon-twitter"></div></a>
                            <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon icon-vimeo"></div></a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Info</h5>
                                <li><a href="/about">Mission</a></li>
                                <li><a href="/about#team">Team</a></li>
                                <li><a href="/about#collaborators">Collaborators</a></li>
                                <li><a href="/careers">Careers</a></li>

                            </ul>
                        </div>

                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Work</h5>
                                <li><a href="/packages/">Packages</a></li>
                                <li><a href="/blog/">Blog</a></li>
                                <li><a href="/technotes/">Tech Notes</a></li>
                                <li><a href="/tutorials/">Tutorials</a></li>
                                <li><a href="/usecases/">Use Cases</a></li>
                                <li><a href="/resources/">More Resources</a></li>
                            </ul>
                        </div>
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Participate</h5>
                                <li><a href="/contact.html">Contact us</a></li>
                                <li><a href="/community/">Community</a></li>
                                <li><a href="http://onboarding.ropensci.org/">Contribute software</a></li>
                                <li><a href="http://unconf17.ropensci.org/">Unconference</a></li>
                                <li><a href="/coc">Code of conduct</a></li>
                                <li><a href="/donate/">Donate</a></li>
                            </ul>
                        </div>
                        <div class="col-4 top-8 bottom-8">
                            <h5 class="bottom-2"></h5>

                            <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                            <a href="http://numfocus.org" target="_blank"><img src="img/numfocus.png"></a>
                            <br>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 top-8 bottom-9 divider">
                    <p class="top-9">Except where otherwise noted, content on this site is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY license</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>



</body>
</html>



