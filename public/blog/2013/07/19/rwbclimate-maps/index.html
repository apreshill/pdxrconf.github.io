<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>rOpenSci | Making maps of climate change</title>

     
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>

    <script type="text/javascript">
    hljs.configure({languages: []});
    hljs.initHighlightingOnLoad();
    </script>
    <link rel="stylesheet" type="text/css" href="/css/style-new.css" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#4b8add">
<meta name="theme-color" content="#4b8add">


    <meta name="viewport" content="width=device-width, initial-scale=1">

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-462421-6', 'auto');
ga('send', 'pageview');
</script>

</head>
<body>

    
    <div id="header">
        <div class="container">
            <div class="row center-m">
                
                <div class="col-1">
                    <a href="/index.html"><img src="/img/icon_lettering_white.svg" /></a>
                </div>
                
                
                <nav class="col-6 col-offset-4 top-3">
                    <ul class="row between">
						<li><a href="/about/">About</a></li>
                        <li><a href="/blog/">Blog</a></li>
                        <li><a href="/packages/">Packages</a></li>
                        <li><a href="/community/">Community</a></li>
                        <li><a href="http://discuss.ropensci.org/" target="_blank">Discuss</a></li>

                    </ul>
                </nav>
                
            </div>
        </div>
    </div>


<article>
    <div class="container">
        <div class="row">
            <div class="col-2 sidebar top-5">
                <ul class="autoSidebar"></ul>
            </div> 
        </div>
        <div class="row">
            <div class="col-offset-2 col-8 top-20">
                <h2 style="text-align: center;">Making maps of climate change</h2>
            </div>
        </div>
        <div class="row">
            <div class="col-offset-2 col-8 top-10 bottom-5" style="font-size: 20px; text-align: center;">
                <p class="authors" style="text-align: center;">
                    
                        
                          <a href="/about/#team"> Ted Hart </a>&nbsp;
                        
                    
                </p>
                <br>
                <div style="font-size: 20px; color: #2C3E50; margin-top: 15px;">July 19, 2013</div>
            </div>
            <div class="col-offset-2 col-8 top-2">

                

                

<p>A recent video on the <a href="http://video.pbs.org/program/idea-channel/">PBS Ideas Channel</a> posited that the discovery of <a href="http://www.youtube.com/watch?v=1M1BPz0nY3s">climate change is humanities greatest scientific achievement</a>. It took synthesizing generations of data from thousands of scientists, hundreds of thousands (if not more) of hours of computer time to run models at institutions all over the world.  But how can the individual researcher get their hands of some this data?  Right now the <a href="http://www.worldbank.org">World Bank</a> provides access to global circulation model (GCM) output from between 1900 and 2100 in 20 year intervals via their <a href="http://data.worldbank.org/developers/climate-data-api">climate data api</a>.  Using our new package <a href="https://github.com/ropensci/rWBclimate">rWBclimate</a> you can access model output from 15 different GCM&rsquo;s, ensemble data from all GCM&rsquo;s aggregated, and historical climate data.  This data is available at two different spatial scales, individual countries or watershed basins. On top of access to all this data, the API provides a way to download <a href="https://developers.google.com/kml/documentation/">KML</a> definitions for each corresponding spatial element (country or basin).  This means with our package it&rsquo;s easy to download climate data and create maps of any of the thousands of datapoints you have access to via the API.</p>

<hr />

<h2 id="install-rwbclimate">Install rWBclimate</h2>

<p><br></p>

<pre><code class="language-r"># install_github('rWBclimate', 'ropensci')
library(rWBclimate)
</code></pre>

<hr />

<h2 id="map-of-north-american-precipitation-anomalies">Map of North American precipitation anomalies</h2>

<p><br></p>

<p>Aside from access to both temperature and preciptation data, you can download anomaly data, showing the change from some time period and a control period of 1961-2009.  Let&rsquo;s create a precipitation anomaly map to see how much change there will be across North America.  The first thing we&rsquo;ll need to do is download the data and subset it so we have one piece of spatial information per KML polygon.  We&rsquo;ll be using examples with preloaded basin ID&rsquo;s, in this case <em>NoAm_basin</em>.  However you can download data with a vector of numbers for <a href="http://data.worldbank.org/sites/default/files/climate_data_api_basins.pdf">basins</a> or countries using three letter <a href="http://unstats.un.org/unsd/methods/m49/m49alpha.htm">ISO country codes</a></p>

<pre><code class="language-r"># Download data for all basins in North America in the 2080-2100 period
prp.dat &lt;- get_ensemble_precip(NoAm_basin,&quot;annualanom&quot;,2080,2100)

#subset the data to the 50th percentile
prp.dat &lt;- subset(prp.dat, prp.dat$scenario == &quot;a2&quot; &amp; prp.dat$percentile == 50)

</code></pre>

<p>Now we should have all the data we need, we need to download the KML files to map.  rWBclimate locally stores KML files in a directory you specify until they are deleted.  You&rsquo;ll need to set kmlpath in the options as follows: <code>options(kmlpath=&quot;/Users/edmundhart/kmltemp&quot;)</code> KML files can be large so when first downloading it can take some time to create a map dataframe.</p>

<pre><code class="language-r">options(kmlpath=&quot;/Users/edmundhart/kmltemp&quot;)
#First create a mapable data frame with the same basin ID's that were used to download data.
prp.map &lt;- create_map_df(NoAm_basin)

</code></pre>

<p>Now that you have your data as well as your dataframe of polygons we just need to use one last function to create a map.  You have two options with this function.  It can return a dataframe that you can map yourself, or a ggplot2 map that can be modified as you see fit like in this example.</p>

<pre><code class="language-r">pranom.map &lt;- climate_map(prp.map,prp.dat)
pranom.map &lt;- pranom.map + scale_fill_continuous(&quot;Precipitation \n anomaly (mm)&quot;, low=&quot;Red&quot;,high = &quot;Blue&quot;)+ylab(&quot;Latitude&quot;)+xlab(&quot;Longitude&quot;) + theme_bw()
</code></pre>

<p>Here you can see that northern latitudes are expected to get much rainier while as you move closer to the equator the climate will become drier.
<img src="/assets/blog-images/2013-07-19-rWBclimate-maps/precipMap.png" alt="center" /></p>

<hr />

<h2 id="creating-a-global-temperature-map">Creating a global temperature map</h2>

<p><br>
You could also create custom global maps.  Let&rsquo;s put it all together and make a world map at the basin level for temperature anomaly.  This will take a bit of time to run beacuse you&rsquo;re downloading 438 kml files.</p>

<pre><code class="language-r">
wtemp.dat &lt;- get_ensemble_temp(1:468,&quot;annualanom&quot;,2080,2100)
wtemp.dat &lt;- subset(wtemp.dat, wtemp.dat$scenario == &quot;a2&quot; &amp; wtemp.dat$percentile == 50)
wtemp.map.df &lt;- create_map_df(1:468)
wtemp.map &lt;- climate_map(wtemp.map.df,wtemp.dat)

wtemp.map &lt;- wtemp.map + scale_fill_continuous(&quot;Temperature \n anomaly&quot;, low=&quot;Yellow&quot;,high = &quot;red&quot;)+ylab(&quot;Latitude&quot;)+xlab(&quot;Longitude&quot;) + theme_bw()

</code></pre>

<p><img src="/assets/blog-images/2013-07-19-rWBclimate-maps/wtempMap.png" alt="center" /></p>

<p>This creates a world map of temperature anomalies. There&rsquo;s a tremendous amount of data available that you can map and and plot available from the climate data api, check out the <a href="https://github.com/ropensci/rWBclimate/blob/master/README.md">vignette up on the github webpage for a full tutorial.</a></p>

            </div>
            <br>
            <div class="col-offset-2 col-8 top-4 labels">
                
                    <a href="/tags/r"><span class="label">R</span></a>
                
                    <a href="/tags/api"><span class="label">API</span></a>
                
                    <a href="/tags/climate"><span class="label">climate</span></a>
                
                    <a href="/tags/maps"><span class="label">maps</span></a>
                
            </div>

            
            
            <div class="col-offset-2 col-8 top-4">
              <div id="disqus_thread"></div>
                <div id="disqus_thread"></div>
                <script type="text/javascript">
                var disqus_shortname = 'ropenscience';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            </div>
            
        </div>
        <br>
    </div>
</article>





    <div id="footer">
        <div class="container">
            <div class="row start">
                <div class="col-1 col-1-3 top-8">
                    <img src="/img/icon_short_white.svg" />
                </div>

                <div class="col-9 col-offset-2 top-10 bottom-8">
                    <div class="row between">
                        <div class="col-2 col-1-3">
                            <a href="http://github.com/ropensci" target="_blank"><div class="icon icon-github"></div></a>
                            <a href="http://twitter.com/ropensci" target="_blank"><div class="icon icon-twitter"></div></a>
                            <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon icon-vimeo"></div></a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Info</h5>
                                <li><a href="/about">Mission</a></li>
                                <li><a href="/about#team">Team</a></li>
                                <li><a href="/about#collaborators">Collaborators</a></li>
                                <li><a href="/careers">Careers</a></li>

                            </ul>
                        </div>

                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Work</h5>
                                <li><a href="/packages/">Packages</a></li>
                                <li><a href="/blog/">Blog</a></li>
                                <li><a href="/technotes/">Tech Notes</a></li>
                                <li><a href="/tutorials/">Tutorials</a></li>
                                <li><a href="/usecases/">Use Cases</a></li>
                                <li><a href="/resources/">More Resources</a></li>
                            </ul>
                        </div>
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Participate</h5>
                                <li><a href="/contact.html">Contact us</a></li>
                                <li><a href="/community/">Community</a></li>
                                <li><a href="http://onboarding.ropensci.org/">Contribute software</a></li>
                                <li><a href="http://unconf17.ropensci.org/">Unconference</a></li>
                                <li><a href="/coc">Code of conduct</a></li>
                                <li><a href="/donate/">Donate</a></li>
                            </ul>
                        </div>
                        <div class="col-4 top-8 bottom-8">
                            <h5 class="bottom-2"></h5>

                            <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                            <a href="http://numfocus.org" target="_blank"><img src="img/numfocus.png"></a>
                            <br>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 top-8 bottom-9 divider">
                    <p class="top-9">Except where otherwise noted, content on this site is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY license</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>



</body>
</html>



