<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>rOpenSci | Style GeoJSON</title>

     
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>

    <script type="text/javascript">
    hljs.configure({languages: []});
    hljs.initHighlightingOnLoad();
    </script>
    <link rel="stylesheet" type="text/css" href="/css/style-new.css" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#4b8add">
<meta name="theme-color" content="#4b8add">


    <meta name="viewport" content="width=device-width, initial-scale=1">

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-462421-6', 'auto');
ga('send', 'pageview');
</script>

</head>
<body>

    
    <div id="header">
        <div class="container">
            <div class="row center-m">
                
                <div class="col-1">
                    <a href="/index.html"><img src="/img/icon_lettering_white.svg" /></a>
                </div>
                
                
                <nav class="col-6 col-offset-4 top-3">
                    <ul class="row between">
						<li><a href="/about/">About</a></li>
                        <li><a href="/blog/">Blog</a></li>
                        <li><a href="/packages/">Packages</a></li>
                        <li><a href="/community/">Community</a></li>
                        <li><a href="http://discuss.ropensci.org/" target="_blank">Discuss</a></li>

                    </ul>
                </nav>
                
            </div>
        </div>
    </div>


<article>
    <div class="container">
        <div class="row">
            <div class="col-2 sidebar top-5">
                <ul class="autoSidebar"></ul>
            </div> 
        </div>
        <div class="row">
            <div class="col-offset-2 col-8 top-20">
                <h2 style="text-align: center;">Style GeoJSON</h2>
            </div>
        </div>
        <div class="row">
            <div class="col-offset-2 col-8 top-10 bottom-5" style="font-size: 20px; text-align: center;">
                <p class="authors" style="text-align: center;">
                    
                        
                          <a href="/about/#team"> Scott Chamberlain </a>&nbsp;
                        
                    
                </p>
                <br>
                <div style="font-size: 20px; color: #2C3E50; margin-top: 15px;">July 17, 2013</div>
            </div>
            <div class="col-offset-2 col-8 top-2">

                

                

<p><a href="http://ropensci.org/blog/2013/07/04/rbison-geoson/">Previously on this blog</a> and on <a href="http://sckott.github.io/2013/06/geojson/">my own personal blog</a>, I have discussed how easy it is to create interactive maps on Github using a combination of R, git and Github. This is done using a file format called <a href="http://en.wikipedia.org/wiki/GeoJSON"><em>geojson</em></a>, a file format based on JSON (JavaScript Object Notation) in which you can specify geographic data along with any other metadata.</p>

<p>In my <a href="http://ropensci.org/blog/2013/07/04/rbison-geoson/">previous post on this blog</a> about <em>geojson</em>, I described how you could get data from the USGS BISON API using our <a href="https://github.com/ropensci/rbison">rbison package</a>, then make a <em>geojson</em> file, then push to Github. Here, I describe briefly how you can style your map. This time, we&rsquo;ll get data from <a href="http://www.gbif.org/">GBIF</a> using the <a href="https://github.com/ropensci/rgbif">rgbif package</a>.</p>

<hr />

<h2 id="load-package">Load package</h2>

<pre><code class="language-r"># install_github('rgbif', 'ropensci')
library(rgbif)
</code></pre>

<hr />

<h2 id="get-data-from-gbif">Get data from GBIF</h2>

<pre><code class="language-r">splist &lt;- c(&quot;Accipiter erythronemius&quot;, &quot;Junco hyemalis&quot;, &quot;Aix sponsa&quot;)
out &lt;- occurrencelist_many(splist, coordinatestatus = TRUE, maxresults = 100)
dat &lt;- gbifdata(out)
head(dat)
</code></pre>

<pre><code>                taxonName decimalLatitude decimalLongitude
1 Accipiter erythronemius          -25.91           -54.36
2 Accipiter erythronemius          -25.86           -54.52
3 Accipiter erythronemius          -25.86           -54.52
4 Accipiter erythronemius          -27.35           -65.60
5 Accipiter erythronemius          -27.35           -65.60
6 Accipiter erythronemius          -27.35           -65.60
</code></pre>

<hr />

<h2 id="style">Style</h2>

<p>We first need to convert column names to be <em>latitude</em> and <em>longitude</em></p>

<pre><code class="language-r">names(dat)[names(dat) %in% c(&quot;decimalLatitude&quot;, &quot;decimalLongitude&quot;)] &lt;- c(&quot;latitude&quot;,
    &quot;longitude&quot;)
</code></pre>

<p>Then use a new function <code>stylegeojson</code> to simply add new columns to the data.frame. With <code>stylegeojson</code> you can add marker colors, symbols, and size. Note that this only works for point/marker maps (not polygon/line) for now. You could also simply edit the geojson file, but that can get very tedious with large files. You can specify color, symbol type, and symbol size all for the same variable, or each of those for different variables - where the ordering of the vector of colors, symbol types and sizes follows the ordering of the unique variable levels. Here we specify a separate color and size for each of the three species within the <em>taxonName</em> variable.</p>

<pre><code class="language-r">dat &lt;- stylegeojson(input = dat, var = &quot;taxonName&quot;, color = c(&quot;#976AAE&quot;, &quot;#6B944D&quot;,
    &quot;#BD5945&quot;), size = &quot;small&quot;)
head(dat)
</code></pre>

<pre><code>                taxonName latitude longitude marker-color marker-size
1 Accipiter erythronemius   -25.91    -54.36      #976AAE       small
2 Accipiter erythronemius   -25.86    -54.52      #976AAE       small
3 Accipiter erythronemius   -25.86    -54.52      #976AAE       small
4 Accipiter erythronemius   -27.35    -65.60      #976AAE       small
5 Accipiter erythronemius   -27.35    -65.60      #976AAE       small
6 Accipiter erythronemius   -27.35    -65.60      #976AAE       small
</code></pre>

<p>Here, specify one color for all three species, and make them all size medium.</p>

<pre><code class="language-r">dat &lt;- stylegeojson(input = dat, var = &quot;taxonName&quot;, color = &quot;#6B944D&quot;, size = &quot;medium&quot;)
</code></pre>

<p>Then write the data.frame to disk, and convert to a <em>geojson</em> file using the function <code>togeojson</code>.</p>

<pre><code class="language-r">write.csv(dat, &quot;~/github/sac/mygeojson/rgbif_data.csv&quot;)
file &lt;- &quot;~/github/sac/mygeojson/rgbif_data.csv&quot;
togeojson(file, method = &quot;web&quot;, destpath = &quot;~/github/sac/mygeojson/&quot;, outfilename = &quot;rgbif_data&quot;)
</code></pre>

<hr />

<h2 id="git-er-done">Git &lsquo;er done</h2>

<p>All we need to do now is go to the command line or your git GUI client and push the changes to Github. If you need help with that see Step 3 in the <a href="http://ropensci.org/blog/2013/07/04/rbison-geoson/">previous geojson post</a>.</p>

<p>Go <a href="https://render.github.com/view/geojson?url=https://raw.github.com/sckott/mygeojson/master/rgbif_data.geojson" target="_blank">here</a> to see the map.</p>

<p>That&rsquo;s it. have a look at your map, have fun, and let us know if you have any feature requests or bug reports at our Github issues tracker for rgbif <a href="https://github.com/ropensci/rgbif/issues">here</a>.</p>

            </div>
            <br>
            <div class="col-offset-2 col-8 top-4 labels">
                
                    <a href="/tags/r"><span class="label">R</span></a>
                
                    <a href="/tags/api"><span class="label">API</span></a>
                
                    <a href="/tags/geojson"><span class="label">geojson</span></a>
                
                    <a href="/tags/json"><span class="label">json</span></a>
                
                    <a href="/tags/maps"><span class="label">maps</span></a>
                
            </div>

            
            
            <div class="col-offset-2 col-8 top-4">
              <div id="disqus_thread"></div>
                <div id="disqus_thread"></div>
                <script type="text/javascript">
                var disqus_shortname = 'ropenscience';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
            </div>
            
        </div>
        <br>
    </div>
</article>





    <div id="footer">
        <div class="container">
            <div class="row start">
                <div class="col-1 col-1-3 top-8">
                    <img src="/img/icon_short_white.svg" />
                </div>

                <div class="col-9 col-offset-2 top-10 bottom-8">
                    <div class="row between">
                        <div class="col-2 col-1-3">
                            <a href="http://github.com/ropensci" target="_blank"><div class="icon icon-github"></div></a>
                            <a href="http://twitter.com/ropensci" target="_blank"><div class="icon icon-twitter"></div></a>
                            <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon icon-vimeo"></div></a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Info</h5>
                                <li><a href="/about">Mission</a></li>
                                <li><a href="/about#team">Team</a></li>
                                <li><a href="/about#collaborators">Collaborators</a></li>
                                <li><a href="/careers">Careers</a></li>

                            </ul>
                        </div>

                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Work</h5>
                                <li><a href="/packages/">Packages</a></li>
                                <li><a href="/blog/">Blog</a></li>
                                <li><a href="/technotes/">Tech Notes</a></li>
                                <li><a href="/tutorials/">Tutorials</a></li>
                                <li><a href="/usecases/">Use Cases</a></li>
                                <li><a href="/resources/">More Resources</a></li>
                            </ul>
                        </div>
                        <div class="col-2 col-1-3 top-8 bottom-8">
                            <ul>
                                <h5 class="bottom-2">Participate</h5>
                                <li><a href="/contact.html">Contact us</a></li>
                                <li><a href="/community/">Community</a></li>
                                <li><a href="http://onboarding.ropensci.org/">Contribute software</a></li>
                                <li><a href="http://unconf17.ropensci.org/">Unconference</a></li>
                                <li><a href="/coc">Code of conduct</a></li>
                                <li><a href="/donate/">Donate</a></li>
                            </ul>
                        </div>
                        <div class="col-4 top-8 bottom-8">
                            <h5 class="bottom-2"></h5>

                            <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                            <a href="http://numfocus.org" target="_blank"><img src="img/numfocus.png"></a>
                            <br>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 top-8 bottom-9 divider">
                    <p class="top-9">Except where otherwise noted, content on this site is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY license</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>



</body>
</html>



